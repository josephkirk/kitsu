(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21f5db39"],{"0f7c9":function(t,s,e){"use strict";var a=e("b246"),i=e.n(a);i.a},"306a":function(t,s,e){"use strict";var a=e("a197"),i=e.n(a);i.a},a197:function(t,s,e){},a426:function(t,s,e){"use strict";var a=e("bbe4"),i=e.n(a);i.a},b131:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("td",{staticClass:"validation"},["pie"===t.displayMode?e("div",{staticClass:"flexrow"},[e("pie-chart",{staticClass:"flexrow-item",attrs:{width:"70px",height:"50px",legend:!1,colors:t.colors,data:t.selectedData}}),t.label?e("span",{staticClass:"tag flexrow-item",style:{"background-color":t.labelColor}},[t._v(" "+t._s(t.label)+" ")]):t._e()],1):e("div",[t._l(t.selectedData,(function(s){return s[0]?e("div",{key:s[0]},[e("span",{staticClass:"stats-name",style:{color:s[2]}},[t._v(" "+t._s(s[0])+" ")]),e("span",[t._v(" : ")]),e("span",{staticClass:"stats-value"},[t._v(" "+t._s(s[1])+" ("+t._s(t.percent(s[1]))+"%) ")])]):t._e()})),t.label?e("span",{staticClass:"tag flexrow-item",style:{"background-color":t.labelColor}},[t._v(" "+t._s(t.label)+" ")]):t._e()],2)])},i=[],o=(e("13d5"),e("b680"),{name:"stats-cell",components:{},props:{colors:{type:Array,required:!0},countMode:{type:String,default:"count"},data:{type:Array,default:function(){return[]}},displayMode:{type:String,default:"pie"},framesData:{type:Array,default:function(){return[]}},label:{type:String,default:""},labelColor:{type:String,default:"#e67e22"}},computed:{selectedData:function(){return"frames"===this.countMode?this.framesData:this.data},total:function(){return this.selectedData.reduce((function(t,s){return s[1]?t+s[1]:t}),0)}},methods:{percent:function(t){var s=0;return this.total>0&&(s=t/this.total*100),s.toFixed(2)}}}),n=o,l=(e("a426"),e("2877")),r=Object(l["a"])(n,a,i,!1,null,"27d76728",null);s["a"]=r.exports},b246:function(t,s,e){},bbe4:function(t,s,e){},d46a:function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"asset-types page fixed-page"},[e("div",{staticClass:"asset-type-list-header page-header flexrow"},[e("search-field",{ref:"asset-type-search-field",staticClass:"flexrow-item mt1",attrs:{placeholder:"ex: chars, agent327"},on:{change:t.onSearchChange}}),e("combobox",{staticClass:"mb0 flexrow-item",attrs:{label:t.$t("statistics.display_mode"),"locale-key-prefix":"statistics.",options:t.displayModeOptions},model:{value:t.displayMode,callback:function(s){t.displayMode=s},expression:"displayMode"}}),e("span",{staticClass:"filler"}),e("button-simple",{staticClass:"flexrow-item",attrs:{icon:"refresh",title:t.$t("main.reload")},on:{click:t.reset}}),e("button-simple",{staticClass:"flexrow-item",attrs:{icon:"download"},on:{click:t.exportStatisticsToCsv}})],1),e("production-asset-type-list",{ref:"asset-type-list",attrs:{entries:t.displayedAssetTypes,"is-loading":t.isAssetsLoading||t.initialLoading,"is-error":t.isAssetsLoadingError,"validation-columns":t.assetValidationColumns,"asset-type-stats":t.assetTypeStats,"display-mode":t.displayMode,"show-all":0===t.assetTypeSearchText.length},on:{scroll:t.saveScrollPosition}})],1)},i=[],o=(e("99af"),e("a15b"),e("a434"),e("b0c0"),e("5530")),n=e("c1df"),l=e.n(n),r=e("2f62"),c=e("3455"),d=e("8c97"),p=e("de40"),u=e("992f"),h=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"data-list"},[e("div",{directives:[{name:"scroll",rawName:"v-scroll",value:t.onBodyScroll,expression:"onBodyScroll"}],ref:"body",staticClass:"datatable-wrapper"},[e("table",{staticClass:"datatable"},[e("thead",{staticClass:"datatable-head"},[e("tr",[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"col"}},[t._v(" "+t._s(t.$t("asset_types.fields.name"))+" ")]),e("th",{staticClass:"validation",attrs:{scope:"col"}},[t._v(t._s(t.$t("main.all")))]),t._l(t.validationColumns,(function(s){return t.isLoading?t._e():e("th",{key:s,staticClass:"validation validation-cell",attrs:{scope:"col"}},[e("div",{staticClass:"flexrow validation-content",style:t.getValidationStyle(s)},[t.isCurrentUserClient?e("span",{staticClass:"flexrow-item"},[t._v(" "+t._s(t.taskTypeMap[s].name)+" ")]):e("router-link",{staticClass:"flexrow-item",attrs:{to:t.taskTypePath(s)}},[t._v(" "+t._s(t.taskTypeMap[s].name)+" ")])],1)])})),e("th",{staticClass:"actions",attrs:{scope:"col"}})],2)]),t.isLoading?t._e():e("tbody",{staticClass:"datatable-body"},[t.showAll&&!t.isEmptyList?e("tr",{staticClass:"all-line datatable-row"},[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[t._v(" "+t._s(t.$t("asset_types.all_asset_types"))+" ")]),e("stats-cell",{attrs:{colors:t.chartColors("all","all"),data:t.chartData("all","all"),displayMode:t.displayMode}}),t._l(t.validationColumns,(function(s){return e("stats-cell",{key:"all-"+s,style:t.getValidationStyle(s),attrs:{colors:t.chartColors("all",s),data:t.chartData("all",s),displayMode:t.displayMode}})})),e("td",{staticClass:"actions"})],2):t._e(),t._l(t.entries,(function(s){return e("tr",{key:s.id,staticClass:"datatable-row"},[e("th",{staticClass:"name datatable-row-header",attrs:{scope:"row"}},[t._v(" "+t._s(s.name)+" ")]),t.isStats(s.id,"all")?e("stats-cell",{attrs:{colors:t.chartColors(s.id,"all"),data:t.chartData(s.id,"all"),displayMode:t.displayMode}}):e("td"),t._l(t.validationColumns,(function(a){return t.isStats(s.id,a)?e("stats-cell",{key:s.id+a,style:t.getValidationStyle(a),attrs:{colors:t.chartColors(s.id,a),data:t.chartData(s.id,a),displayMode:t.displayMode}}):e("td",{style:t.getValidationStyle(a)})})),e("td",{staticClass:"actions"})],2)}))],2)])]),e("table-info",{attrs:{"is-loading":t.isLoading,"is-error":t.isError}}),!t.isEmptyList||t.isCurrentUserClient||t.isLoading?t._e():e("div",{staticClass:"has-text-centered"},[t._m(0),e("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list")))]),e("button-link",{staticClass:"level-item big-button",attrs:{text:t.$t("assets.new_asset"),path:t.newAssetPath}})],1),t.isEmptyList&&t.isCurrentUserClient&&!t.isLoading?e("div",{staticClass:"has-text-centered"},[t._m(1),e("p",{staticClass:"info"},[t._v(t._s(t.$t("assets.empty_list_client")))])]):t._e(),t.isEmptyList||t.isLoading?t._e():e("p",{staticClass:"has-text-centered nb-asset-types"},[t._v(" "+t._s(t.displayedAssetTypesLength)+" "+t._s(t.$tc("asset_types.number",t.displayedAssetTypesLength))+" ")])],1)},y=[function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",{staticClass:"info"},[a("img",{attrs:{src:e("66a5")}})])},function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("p",{staticClass:"info"},[a("img",{attrs:{src:e("66a5")}})])}],f=(e("d3b7"),e("ddb0"),e("e9c6")),m=e("09d3"),b=e("e211"),_=e("b131"),T=e("e60b"),C={name:"production-asset-type-list",mixins:[f["a"]],props:{displayMode:{type:String,default:"pie"},entries:{type:Array,default:function(){return[]}},isLoading:{type:Boolean,default:!1},isError:{type:Boolean,default:!1},assetTypeStats:{type:Object,default:function(){}},showAll:{type:Boolean,default:!1},validationColumns:{type:Array,default:function(){return[]}}},data:function(){return{busy:!1,lastSelection:null}},components:{ButtonLink:b["a"],StatsCell:_["a"],TableInfo:T["a"]},computed:Object(o["a"])(Object(o["a"])({},Object(r["c"])(["assetTypeSearchText","currentEpisode","currentProduction","displayedAssetTypesLength","isCurrentUserClient","isTVShow","taskTypeMap"])),{},{isEmptyList:function(){return this.entries&&0===this.entries.length&&!this.isLoading&&!this.isError&&(!this.assetTypeSearchText||0===this.assetTypeSearchText.length)},newAssetPath:function(){var t={name:"new-asset",params:{production_id:this.currentProduction.id}};return this.isTVShow&&this.currentEpisode&&(t.name="episode-new-asset",t.params.episode_id=this.currentEpisode.id),t}}),methods:Object(o["a"])(Object(o["a"])({},Object(r["b"])([])),{},{chartColors:function(t,s){return Object(m["b"])(this.assetTypeStats,t,s)},chartData:function(t,s){return Object(m["c"])(this.assetTypeStats,t,s)},isStats:function(t,s){return this.assetTypeStats[t]&&this.assetTypeStats[t][s]},onHeaderScroll:function(t,s){this.$refs.tableWrapper.scrollLeft=s.scrollLeft},onBodyScroll:function(t,s){this.$emit("scroll",s.scrollTop)},setScrollPosition:function(t){this.$refs.body&&(this.$refs.body.scrollTop=t)},taskTypePath:function(t){var s={name:"task-type",params:{production_id:this.currentProduction.id,task_type_id:t,type:"assets"}};return this.isTVShow&&this.currentEpisode&&(s.name="episode-task-type",s.params.episode_id=this.currentEpisode.id),s},resizeHeaders:function(){}})},v=C,S=(e("0f7c9"),e("2877")),g=Object(S["a"])(v,h,y,!1,null,"3a70bb20",null),x=g.exports,w=e("4d04"),L={name:"production-asset-types",components:{ButtonSimple:p["a"],Combobox:u["a"],ProductionAssetTypeList:x,SearchField:w["a"]},data:function(){return{initialLoading:!0,displayMode:"pie",displayModeOptions:[{label:"pie",value:"pie"},{label:"count",value:"count"}]}},computed:Object(o["a"])({},Object(r["c"])(["assetTypeMap","assetTypePath","assetTypeStats","assetTypeSearchText","assetTypeListScrollPosition","assetValidationColumns","currentEpisode","currentProduction","displayedAssetTypes","isAssetsLoading","isAssetsLoadingError","isTVShow","taskStatusMap","taskTypeMap"])),created:function(){},mounted:function(){var t=this;this.setDefaultSearchText(),this.setDefaultListScrollPosition(),setTimeout((function(){t.reset()}),100)},methods:Object(o["a"])(Object(o["a"])({},Object(r["b"])(["computeAssetTypeStats","initAssetTypes","loadAssets","setAssetTypeSearch","setAssetTypeListScrollPosition","setLastProductionScreen"])),{},{setDefaultSearchText:function(){this.assetTypeSearchText.length>0&&this.$refs["asset-type-search-field"].setValue(this.assetTypeSearchText)},setDefaultListScrollPosition:function(){this.$refs["asset-type-list"].setScrollPosition(this.assetTypeListScrollPosition)},navigateToList:function(){this.$router.push(this.assetTypesPath)},onSearchChange:function(t){var s=this.$refs["asset-type-search-field"].getValue();this.setAssetTypeSearch(s)},saveScrollPosition:function(t){this.setAssetTypeListScrollPosition(t)},exportStatisticsToCsv:function(){var t=[l()().format("YYYYMMDD"),this.currentProduction.name,"asset_types","statistics"];this.currentEpisode&&t.splice(2,0,this.currentEpisode.name);var s=d["a"].slugify(t.join("_"));c["a"].generateStatReports(s,this.assetTypeStats,this.taskTypeMap,this.taskStatusMap,this.assetTypeMap,this.countMode)},reset:function(){var t=this;this.initialLoading=!0,this.$refs["asset-type-search-field"].setValue(""),this.loadAssets().then(this.handleModalsDisplay).then((function(){t.computeAssetTypeStats(),t.setAssetTypeListScrollPosition(0),t.initialLoading=!1}))}}),watch:{currentProduction:function(){this.isTVShow||this.reset()},currentEpisode:function(){this.isTVShow&&this.reset()}},metaInfo:function(){return{title:"".concat(this.currentProduction.name," | ").concat(this.$t("asset_types.production_title")," - Kitsu")}}},M=L,k=Object(S["a"])(M,a,i,!1,null,"a2680e28",null);s["default"]=k.exports},e211:function(t,s,e){"use strict";var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("router-link",{staticClass:"button",attrs:{title:t.title,to:t.path}},[t.icon.length>0&&t.icon.startsWith("fa")?e("span",{staticClass:"icon is-small"},[e("i",{class:"fa "+t.icon})]):t._e(),"plus"===t.icon?e("plus-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"download"===t.icon?e("download-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"upload"===t.icon?e("upload-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"edit"===t.icon?e("edit-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"delete"===t.icon?e("trash-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),"restore"===t.icon?e("rotate-ccw-icon",{class:{icon:!0,"is-small":!0,"only-icon":!t.isText}}):t._e(),t.isText?e("span",{class:{text:!0,"is-hidden-touch":t.isResponsive}},[t._v(" "+t._s(t.text)+" ")]):t._e()],1)},i=[],o=e("0a35"),n={name:"button-link",components:{DownloadIcon:o["q"],EditIcon:o["s"],PlusIcon:o["K"],RotateCcwIcon:o["N"],TrashIcon:o["V"],UploadIcon:o["X"]},props:{text:{default:"",type:String},title:{default:"",type:String},path:{default:""},icon:{default:"",type:String},isResponsive:{default:!1,type:Boolean}},computed:{isText:function(){return this.text&&this.text.length>0}}},l=n,r=(e("306a"),e("2877")),c=Object(r["a"])(l,a,i,!1,null,"9fdb2d6c",null);s["a"]=c.exports}}]);
//# sourceMappingURL=chunk-21f5db39.147a438b.js.map