{"version":3,"sources":["webpack:///./src/components/pages/MainSchedule.vue?a138","webpack:///src/components/pages/MainSchedule.vue","webpack:///./src/components/pages/MainSchedule.vue?7e03","webpack:///./src/components/pages/MainSchedule.vue","webpack:///./src/components/pages/MainSchedule.vue?5f7a"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","$t","attrs","locale","days","model","value","callback","$$v","selectedStartDate","expression","selectedEndDate","zoomOptions","zoomLevel","endDate","scheduleItems","loading","schedule","errors","startDate","on","onScheduleItemChanged","changeZoom","expandProductionElement","staticRenderFns","name","components","ComboboxNumber","Datepicker","Schedule","data","mounted","reset","computed","user","methods","event","wheelDelta","convertScheduleItems","openProductions","toDate","map","avatar","item","type","color","colors","expanded","editable","route","children","convertTaskTypeScheduleItems","taskType","productionElement","loadScheduleItems","saveScheduleItem","editProduction","id","start_date","format","end_date","socket","watch","metaInfo","title","component"],"mappings":"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","file":"js/chunk-6e2b0e55.c99963b9.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"columns fixed-page\"},[_c('div',{staticClass:\"column main-column\"},[_c('div',{staticClass:\"flexrow project-dates\"},[_c('div',{staticClass:\"flexrow-item\"},[_c('label',{staticClass:\"label\"},[_vm._v(\" \"+_vm._s(_vm.$t('main.start_date'))+\" \")]),_c('datepicker',{attrs:{\"wrapper-class\":\"datepicker\",\"input-class\":\"date-input input\",\"language\":_vm.locale,\"disabled-dates\":{ days: [6, 0] },\"monday-first\":true,\"format\":\"yyyy-MM-dd\"},model:{value:(_vm.selectedStartDate),callback:function ($$v) {_vm.selectedStartDate=$$v},expression:\"selectedStartDate\"}})],1),_c('div',{staticClass:\"flexrow-item field\"},[_c('label',{staticClass:\"label\"},[_vm._v(\" \"+_vm._s(_vm.$t('main.end_date'))+\" \")]),_c('datepicker',{attrs:{\"wrapper-class\":\"datepicker\",\"input-class\":\"date-input input\",\"language\":_vm.locale,\"disabled-dates\":{ days: [6, 0] },\"monday-first\":true,\"format\":\"yyyy-MM-dd\"},model:{value:(_vm.selectedEndDate),callback:function ($$v) {_vm.selectedEndDate=$$v},expression:\"selectedEndDate\"}})],1),_c('combobox-number',{staticClass:\"flexrow-item zoom-level\",attrs:{\"label\":_vm.$t('schedule.zoom_level'),\"options\":_vm.zoomOptions},model:{value:(_vm.zoomLevel),callback:function ($$v) {_vm.zoomLevel=$$v},expression:\"zoomLevel\"}})],1),_c('schedule',{attrs:{\"end-date\":_vm.endDate,\"hierarchy\":_vm.scheduleItems,\"is-loading\":_vm.loading.schedule,\"is-error\":_vm.errors.schedule,\"start-date\":_vm.startDate,\"with-milestones\":false,\"zoom-level\":_vm.zoomLevel},on:{\"item-changed\":_vm.onScheduleItemChanged,\"change-zoom\":_vm.changeZoom,\"root-element-expanded\":_vm.expandProductionElement}})],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div\r\n  class=\"columns fixed-page\"\r\n>\r\n  <div\r\n    class=\"column main-column\"\r\n  >\r\n    <div class=\"flexrow project-dates\">\r\n      <div class=\"flexrow-item\">\r\n        <label class=\"label\">\r\n          {{ $t('main.start_date') }}\r\n        </label>\r\n        <datepicker\r\n          wrapper-class=\"datepicker\"\r\n          input-class=\"date-input input\"\r\n          :language=\"locale\"\r\n          :disabled-dates=\"{ days: [6, 0] }\"\r\n          :monday-first=\"true\"\r\n          format=\"yyyy-MM-dd\"\r\n          v-model=\"selectedStartDate\"\r\n        />\r\n      </div>\r\n      <div class=\"flexrow-item field\">\r\n        <label class=\"label\">\r\n          {{ $t('main.end_date') }}\r\n        </label>\r\n        <datepicker\r\n          wrapper-class=\"datepicker\"\r\n          input-class=\"date-input input\"\r\n          :language=\"locale\"\r\n          :disabled-dates=\"{ days: [6, 0] }\"\r\n          :monday-first=\"true\"\r\n          format=\"yyyy-MM-dd\"\r\n          v-model=\"selectedEndDate\"\r\n        />\r\n      </div>\r\n      <combobox-number\r\n        class=\"flexrow-item zoom-level\"\r\n        :label=\"$t('schedule.zoom_level')\"\r\n        :options=\"zoomOptions\"\r\n        v-model=\"zoomLevel\"\r\n      />\r\n    </div>\r\n\r\n    <schedule\r\n      :end-date=\"endDate\"\r\n      :hierarchy=\"scheduleItems\"\r\n      :is-loading=\"loading.schedule\"\r\n      :is-error=\"errors.schedule\"\r\n      :start-date=\"startDate\"\r\n      :with-milestones=\"false\"\r\n      :zoom-level=\"zoomLevel\"\r\n      @item-changed=\"onScheduleItemChanged\"\r\n      @change-zoom=\"changeZoom\"\r\n      @root-element-expanded=\"expandProductionElement\"\r\n    />\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\n/*\r\n * Page to manage the schedule of the big steps of the production. It allows\r\n * to set milestones too.\r\n */\r\nimport { mapGetters, mapActions } from 'vuex'\r\nimport moment from 'moment-timezone'\r\nimport { en, fr } from 'vuejs-datepicker/dist/locale'\r\nimport Datepicker from 'vuejs-datepicker'\r\nimport { getProductionSchedulePath } from '../../lib/path'\r\n\r\nimport {\r\n  getFirstStartDate,\r\n  getLastEndDate,\r\n  getStartDateFromString,\r\n  getEndDateFromString\r\n} from '../../lib/time'\r\nimport colors from '../../lib/colors'\r\n\r\nimport ComboboxNumber from '../widgets/ComboboxNumber'\r\nimport Schedule from './schedule/Schedule'\r\n\r\nexport default {\r\n  name: 'production-schedule',\r\n  components: {\r\n    ComboboxNumber,\r\n    Datepicker,\r\n    Schedule\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      endDate: moment().add(6, 'months'),\r\n      scheduleItems: [],\r\n      startDate: moment(),\r\n      selectedStartDate: null,\r\n      selectedEndDate: null,\r\n      zoomLevel: 2,\r\n      zoomOptions: [\r\n        { label: '1', value: 1 },\r\n        { label: '2', value: 2 },\r\n        { label: '3', value: 3 }\r\n      ],\r\n      loading: {\r\n        schedule: false\r\n      },\r\n      errors: {\r\n        schedule: false\r\n      }\r\n    }\r\n  },\r\n\r\n  mounted () {\r\n    this.reset()\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters([\r\n      'openProductions',\r\n      'taskTypeMap',\r\n      'user'\r\n    ]),\r\n\r\n    locale () {\r\n      if (this.user.locale === 'fr_FR') {\r\n        return fr\r\n      } else {\r\n        return en\r\n      }\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions([\r\n      'editProduction',\r\n      'loadScheduleItems',\r\n      'saveScheduleItem'\r\n    ]),\r\n\r\n    changeZoom (event) {\r\n      if (event.wheelDelta < 0 && this.zoomLevel > 1) this.zoomLevel--\r\n      if (event.wheelDelta > 0 && this.zoomLevel < 3) this.zoomLevel++\r\n    },\r\n\r\n    reset () {\r\n      this.scheduleItems = this.convertScheduleItems(this.openProductions)\r\n      this.startDate = getFirstStartDate(this.scheduleItems)\r\n      this.endDate = getLastEndDate(this.scheduleItems)\r\n      this.selectedStartDate = this.startDate.toDate()\r\n      this.selectedEndDate = this.endDate.toDate()\r\n    },\r\n\r\n    convertScheduleItems (scheduleItems) {\r\n      return scheduleItems.map((item) => {\r\n        const startDate = getStartDateFromString(item.start_date)\r\n        const endDate = getEndDateFromString(startDate, item.end_date)\r\n        return {\r\n          ...item,\r\n          avatar: item.type === 'Project',\r\n          color: item.color || colors.fromString(item.name, true),\r\n          startDate: startDate,\r\n          endDate: endDate,\r\n          expanded: false,\r\n          loading: false,\r\n          editable: true,\r\n          route: getProductionSchedulePath(item.id),\r\n          children: []\r\n        }\r\n      })\r\n    },\r\n\r\n    convertTaskTypeScheduleItems (scheduleItems) {\r\n      return scheduleItems.map((item) => {\r\n        const startDate = getStartDateFromString(item.start_date)\r\n        const endDate = getEndDateFromString(startDate, item.end_date)\r\n        const taskType = this.taskTypeMap[item.task_type_id]\r\n\r\n        return {\r\n          ...item,\r\n          name: taskType.name,\r\n          color: taskType.color,\r\n          startDate: startDate,\r\n          endDate: endDate,\r\n          expanded: false,\r\n          loading: false,\r\n          editable: true,\r\n          children: []\r\n        }\r\n      })\r\n    },\r\n\r\n    expandProductionElement (productionElement) {\r\n      if (!productionElement.expanded) {\r\n        productionElement.loading = true\r\n        productionElement.expanded = true\r\n        this.loadScheduleItems(productionElement)\r\n          .then((scheduleItems) => {\r\n            scheduleItems = this.convertTaskTypeScheduleItems(scheduleItems)\r\n            productionElement.children = scheduleItems\r\n            productionElement.loading = false\r\n          })\r\n      } else {\r\n        productionElement.expanded = false\r\n      }\r\n    },\r\n\r\n    onScheduleItemChanged (item) {\r\n      if (item.type !== 'Project') {\r\n        this.saveScheduleItem(item)\r\n      } else {\r\n        this.editProduction({\r\n          id: item.id,\r\n          start_date: item.startDate.format('YYYY-MM-DD'),\r\n          end_date: item.endDate.format('YYYY-MM-DD')\r\n        })\r\n      }\r\n    }\r\n  },\r\n\r\n  socket: {\r\n  },\r\n\r\n  watch: {\r\n  },\r\n\r\n  metaInfo () {\r\n    return {\r\n      title: `${this.$t('schedule.title_main')} - Kitsu`\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.dark {\r\n  .project-dates {\r\n    color: $white-grey;\r\n    border-bottom: 1px solid $grey;\r\n  }\r\n}\r\n\r\n.project-dates {\r\n  border-bottom: 1px solid #EEE;\r\n  padding-bottom: 1em;\r\n\r\n  .field {\r\n    padding-bottom: 0;\r\n    margin-bottom: 0;\r\n  }\r\n\r\n  .overall-man-days {\r\n    width: 120px;\r\n    font-size: 0.9em;\r\n    margin-right: 1em;\r\n  }\r\n}\r\n\r\n.fixed-page {\r\n  padding: 1em;\r\n  padding-top: 90px;\r\n  padding-left: 2em;\r\n}\r\n\r\n.main-column {\r\n  display: flex;\r\n  border: 0;\r\n  overflow: hidden;\r\n  flex-direction: column;\r\n}\r\n\r\n.zoom-level {\r\n  margin-top: -10px;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainSchedule.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainSchedule.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MainSchedule.vue?vue&type=template&id=39b708a9&scoped=true&\"\nimport script from \"./MainSchedule.vue?vue&type=script&lang=js&\"\nexport * from \"./MainSchedule.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MainSchedule.vue?vue&type=style&index=0&id=39b708a9&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"39b708a9\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MainSchedule.vue?vue&type=style&index=0&id=39b708a9&lang=scss&scoped=true&\""],"sourceRoot":""}