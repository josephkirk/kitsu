(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78b93c2b"],{"7a22":function(t,e,s){},d2b5:function(t,e,s){"use strict";s("7a22")},de06:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"columns fixed-page shot"},[s("div",{staticClass:"column main-column"},[s("div",{staticClass:"page-header flexrow"},[s("router-link",{staticClass:"flexrow-item has-text-centered back-link",attrs:{to:t.shotsPath}},[s("chevron-left-icon")],1),t.currentShot?s("entity-thumbnail",{staticClass:"shot-thumbnail flexrow-item",attrs:{entity:t.currentShot,"with-link":!1}}):t._e(),s("div",{staticClass:"flexrow-item"},[s("page-title",{staticClass:"entity-title",attrs:{text:t.title}})],1),s("div",{staticClass:"flexrow-item"},[t.isCurrentUserManager?s("button-simple",{attrs:{icon:"edit"},on:{click:function(e){t.modals.edit=!0}}}):t._e()],1)],1),s("div",{staticClass:"flexrow infos"},[s("div",{staticClass:"flexrow-item"},[s("page-subtitle",{attrs:{text:t.$t("shots.tasks")}}),s("entity-task-list",{staticClass:"task-list",attrs:{entries:t.currentTasks,"is-loading":!t.currentShot,"is-error":!1},on:{"task-selected":t.onTaskSelected}})],1),s("div",{staticClass:"flexrow-item"},[s("page-subtitle",{attrs:{text:t.$t("main.info")}}),s("div",{staticClass:"table-body"},[t.currentShot?s("table",{staticClass:"datatable"},[s("tbody",{staticClass:"datatable-body"},[t.currentShot.data&&t.currentShot.data.fps?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.fps")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.fps:"")+" ")])]):t._e(),t.currentShot.data&&t.currentShot.data.frame_in?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.frame_in")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.frame_in:"")+" ")])]):t._e(),t.currentShot.data&&t.currentShot.data.frame_out?s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.frame_out")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.data.frame_out:"")+" ")])]):t._e(),s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.description")))]),s("description-cell",{attrs:{entry:t.currentShot,full:!0}})],1),s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(t.$t("shots.fields.nb_frames")))]),s("td",[t._v(" "+t._s(t.currentShot?t.currentShot.nb_frames:"")+" ")])]),t._l(t.shotMetadataDescriptors,(function(e){return s("tr",{key:e.id,staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v(t._s(e.name))]),s("td",[t._v(" "+t._s(t.currentShot.data?t.currentShot.data[e.field_name]:"")+" ")])])})),s("tr",{staticClass:"datatable-row"},[s("td",{staticClass:"field-label"},[t._v("Metadata")]),s("td",[s("v-jsoneditor",{staticClass:"json-editor",attrs:{options:t.options,plus:!0,height:"400px"},model:{value:t.metadata,callback:function(e){t.metadata=e},expression:"metadata"}})],1)])],2)]):t._e()])],1)]),s("div",{staticClass:"shot-casting"},[s("page-subtitle",{attrs:{text:t.$t("shots.casting")}}),t.currentShot?s("div",[t.currentShot.castingAssetsByType&&t.currentShot.castingAssetsByType[0].length>0?s("div",t._l(t.currentShot.castingAssetsByType,(function(e){return s("div",{key:e.length>0?e[0].asset_type_name:"",staticClass:"type-assets"},[s("div",{staticClass:"asset-type"},[t._v(" "+t._s(e.length>0?e[0].asset_type_name:"")+" ("+t._s(e.length)+") ")]),s("div",{staticClass:"asset-list"},t._l(e,(function(e){return s("router-link",{key:e.id,staticClass:"asset-link",attrs:{to:t.buildAssetRoute(e)}},[s("entity-thumbnail",{attrs:{entity:e,square:!0,"empty-width":103,"empty-height":103,"with-link":!1}}),s("div",[s("span",[t._v(t._s(e.asset_name))]),e.nb_occurences>1?s("span",[t._v(" ("+t._s(e.nb_occurences)+") ")]):t._e()])],1)})),1)])})),0):s("div",[t._v(" "+t._s(t.$t("shots.no_casting"))+" ")])]):s("table-info",{attrs:{"is-loading":t.casting.isLoading,"is-error":t.casting.isError}})],1)]),t.currentTask?s("div",{staticClass:"column side-column"},[s("task-info",{attrs:{task:t.currentTask}})],1):t._e(),s("edit-shot-modal",{ref:"edit-shot-modal",attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"shot-to-edit":t.currentShot},on:{cancel:function(e){t.modals.edit=!1},confirm:t.confirmEditShot}})],1)},i=[],n=(s("b0c0"),s("b64b"),s("5530")),r=s("bcb2"),o=s.n(r),c=s("2f62"),d=s("0a35"),l=s("9d8b"),h=s("de40"),u=s("0fcb"),f=s("162b"),_=s("bb21"),m=s("0024"),b=s("8d07"),S=s("8751"),p=s("e60b"),g=s("9d94"),v={name:"shot",components:{VJsoneditor:o.a,ButtonSimple:h["a"],ChevronLeftIcon:d["j"],DescriptionCell:u["a"],EditShotModal:f["a"],EntityThumbnail:_["a"],EntityTaskList:m["a"],PageSubtitle:S["a"],PageTitle:b["a"],TableInfo:p["a"],TaskInfo:g["a"]},data:function(){return{currentShot:null,currentTask:null,casting:{isLoading:!1,isError:!1},errors:{edit:!1},loading:{edit:!1},modals:{edit:!1},metadata:{},options:{name:"metadata root",mode:"preview",modes:["tree","preview","form","code"]}}},mounted:function(){var t=this;this.clearSelectedTasks(),this.currentShot=this.getCurrentShot(),this.casting.isLoading=!0,this.casting.isError=!1,Object.assign(this.options,{onChangeText:this.onChangeMetadata}),this.currentShot?(this.currentShot.data&&this.currentShot.data.metadata&&(this.metadata=this.currentShot.data.metadata),this.loadShotCasting(this.currentShot).then((function(){t.casting.isLoading=!1})).catch((function(e){t.casting.isError=!0,console.error(e)}))):this.resetData()},computed:Object(n["a"])(Object(n["a"])({},Object(c["c"])(["currentEpisode","currentProduction","isCurrentUserManager","isTVShow","route","taskMap","shotMap","shotMetadataDescriptors","shotsPath"])),{},{currentTasks:function(){return this.currentShot?this.currentShot.tasks:[]},title:function(){return this.currentShot?this.currentShot.episode_name?"".concat(this.currentShot.episode_name," / ")+"".concat(this.currentShot.sequence_name," / ")+"".concat(this.currentShot.name):"".concat(this.currentShot.sequence_name," / ")+"".concat(this.currentShot.name):"Loading..."},shotThumbnailPath:function(){var t=this.currentShot.preview_file_id;return"/api/pictures/originals/preview-files/".concat(t,".png")},isPreview:function(){return this.currentShot&&this.currentShot.preview_file_id&&this.currentShot.preview_file_id.length>0}}),methods:Object(n["a"])(Object(n["a"])({},Object(c["b"])(["clearSelectedTasks","editShot","loadAssets","loadShots","loadShotCasting"])),{},{onChangeMetadata:function(t){console.log(t)},changeTab:function(t){this.selectedTab=t},getCurrentShot:function(){return this.shotMap[this.route.params.shot_id]||null},onEditClicked:function(){this.modals.edit=!0},confirmEditShot:function(t){var e=this;t.id=this.currentShot.id,this.loading.edit=!0,this.errors.edit=!1,this.editShot(t).then((function(){e.loading.edit=!1,e.modals.edit=!1})).catch((function(t){console.error(t),e.loading.edit=!1,e.errors.edit=!0}))},onTaskSelected:function(t){this.currentTask=t},buildAssetRoute:function(t){var e=t.episode_id;this.isTVShow&&!e&&(e="main");var s={name:"asset",params:{production_id:this.currentProduction.id,asset_id:t.asset_id}};return Object(l["a"])(s,e)},resetData:function(){var t=this;this.loadShots((function(){t.loadAssets().then((function(){return t.currentShot=t.getCurrentShot(),t.loadShotCasting(t.currentShot).then((function(){t.casting.isLoading=!1})).catch((function(e){console.error(e),t.casting.isError=!0}))}))}))}}),watch:{currentProduction:function(){this.isTVShow||this.resetData()},currentEpisode:function(){this.isTVShow&&0===Object.keys(this.shotMap).length&&this.resetData()}},metaInfo:function(){return{title:"".concat(this.title," - Kitsu")}}},C=v,k=(s("d2b5"),s("2877")),w=Object(k["a"])(C,a,i,!1,null,"aba8a800",null);e["default"]=w.exports}}]);
//# sourceMappingURL=chunk-78b93c2b.344abd99.js.map