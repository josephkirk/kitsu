(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53b747de"],{"0dd7":function(t,s,e){"use strict";e.r(s);var a=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"columns fixed-page asset"},[e("div",{staticClass:"column main-column"},[e("div",{staticClass:"page-header flexrow"},[e("router-link",{staticClass:"flexrow-item has-text-centered back-link",attrs:{to:t.assetsPath}},[e("chevron-left-icon")],1),t.currentAsset?e("entity-thumbnail",{staticClass:"asset-thumbnail flexrow-item",attrs:{entity:t.currentAsset,"with-link":!1}}):t._e(),e("div",{staticClass:"flexrow-item"},[e("page-title",{staticClass:"entity-title",attrs:{text:t.title}})],1),e("div",{staticClass:"flexrow-item"},[t.isCurrentUserManager?e("button-simple",{attrs:{icon:"edit"},on:{click:function(s){t.modals.edit=!0}}}):t._e()],1)],1),e("div",{staticClass:"flexrow infos"},[e("div",{staticClass:"flexrow-item"},[e("page-subtitle",{attrs:{text:t.$t("assets.tasks")}}),e("entity-task-list",{staticClass:"task-list",attrs:{entries:t.currentAsset?t.currentAsset.tasks:[],"is-loading":!t.currentAsset,"is-error":!1},on:{"task-selected":t.onTaskSelected}})],1),e("div",{staticClass:"flexrow-item"},[e("page-subtitle",{attrs:{text:t.$t("main.info")}}),e("div",{staticClass:"table-body"},[t.currentAsset?e("table",{staticClass:"datatable"},[e("tbody",{staticClass:"table-body"},[e("tr",{staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(t.$t("assets.fields.description")))]),e("description-cell",{attrs:{entry:t.currentAsset,full:!0}})],1),t._l(t.assetMetadataDescriptors,(function(s){return e("tr",{key:s.id,staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v(t._s(s.name))]),e("td",[t._v(" "+t._s(t.currentAsset.data?t.currentAsset.data[s.field_name]:"")+" ")])])})),e("tr",{staticClass:"datatable-row"},[e("td",{staticClass:"field-label"},[t._v("Metadata")]),e("td",[e("v-jsoneditor",{staticClass:"json-editor",attrs:{options:t.options,plus:!0,height:"400px"},model:{value:t.metadata,callback:function(s){t.metadata=s},expression:"metadata"}})],1)])],2)]):t._e()])],1)]),e("div",{staticClass:"asset-casted-in"},[e("page-subtitle",{attrs:{text:t.$t("assets.cast_in")}}),t.currentAsset?e("div",[t.currentAsset.castInShotsBySequence&&t.currentAsset.castInShotsBySequence[0].length>0?e("div",t._l(t.currentAsset.castInShotsBySequence,(function(s){return s[0].sequence_name?e("div",{key:s.length>0?s[0].sequence_name:"",staticClass:"sequence-shots"},[e("div",{staticClass:"shot-sequence"},[t._v(" "+t._s(s.length>0?s[0].sequence_name:"")+" ")]),e("div",{staticClass:"shot-list"},t._l(s,(function(s){return e("router-link",{key:s.shot_id,staticClass:"shot-link",attrs:{to:t.shotPath(s)}},[e("entity-thumbnail",{attrs:{entity:s,square:!0,"empty-width":103,"empty-height":103,"with-link":!1}}),e("div",[e("span",[t._v(t._s(s.shot_name))]),s.nb_occurences>1?e("span",[t._v(" ("+t._s(s.nb_occurences)+") ")]):t._e()])],1)})),1)]):t._e()})),0):e("div",[t._v(" "+t._s(t.$t("assets.no_cast_in"))+" ")])]):e("table-info",{attrs:{"is-loading":t.castIn.isLoadin,"is-error":t.castIn.isError}}),t.currentAsset&&t.currentAsset.castingAssetsByType&&t.currentAsset.castingAssetsByType[0].length>0?e("div",[e("page-subtitle",{attrs:{text:"Linked"}}),t.currentAsset.castingAssetsByType&&t.currentAsset.castingAssetsByType[0].length>0?e("div",t._l(t.currentAsset.castingAssetsByType,(function(s){return e("div",{key:s.length>0?s[0].asset_type_name:"",staticClass:"type-assets"},[e("div",{staticClass:"asset-type"},[t._v(" "+t._s(s.length>0?s[0].asset_type_name:"")+" ("+t._s(s.length)+") ")]),e("div",{staticClass:"asset-list"},t._l(s,(function(s){return e("router-link",{key:s.id,staticClass:"asset-link",attrs:{to:{name:"asset",params:{production_id:t.currentProduction.id,asset_id:s.asset_id}}}},[e("entity-thumbnail",{attrs:{entity:s,square:!0,"empty-width":103,"empty-height":103,"with-link":!1}}),e("div",[e("span",[t._v(t._s(s.asset_name))]),s.nb_occurences>1?e("span",[t._v(" ("+t._s(s.nb_occurences)+") ")]):t._e()])],1)})),1)])})),0):t._e()],1):t._e()],1)]),t.currentTask?e("div",{staticClass:"column side-column"},[e("task-info",{attrs:{task:t.currentTask}})],1):t._e(),e("edit-asset-modal",{ref:"edit-asset-modal",attrs:{active:t.modals.edit,"is-loading":t.loading.edit,"is-error":t.errors.edit,"asset-to-edit":t.currentAsset},on:{cancel:function(s){t.modals.edit=!1},confirm:t.confirmEditAsset}})],1)},i=[],n=(e("b0c0"),e("5530")),r=e("bcb2"),c=e.n(r),o=e("2f62"),d=e("0a35"),l=e("de40"),u=e("0fcb"),h=e("813f"),_=e("0024"),p=e("bb21"),m=e("8d07"),f=e("8751"),A=e("e60b"),b=e("9d94"),v={name:"asset",components:{VJsoneditor:c.a,ButtonSimple:l["a"],ChevronLeftIcon:d["j"],DescriptionCell:u["a"],EditAssetModal:h["a"],EntityThumbnail:p["a"],EntityTaskList:_["a"],PageSubtitle:f["a"],PageTitle:m["a"],TableInfo:A["a"],TaskInfo:b["a"]},data:function(){return{currentAsset:null,currentTask:null,castIn:{isLoading:!1,isError:!1},errors:{edit:!1},loading:{edit:!1},modals:{edit:!1},metadata:{},options:{name:"metadata root",mode:"preview",modes:["tree","preview","form","code"]}}},mounted:function(){var t=this;this.clearSelectedTasks(),this.currentAsset=this.getCurrentAsset(),this.castIn.isLoading=!0,this.castIn.isError=!1,Object.assign(this.options,{onChangeText:this.onChangeMetadata}),this.currentAsset?(this.currentAsset.data&&this.currentAsset.data.metadata&&(this.metadata=this.currentAsset.data.metadata),this.loadAssetCastIn(this.currentAsset).then((function(){return t.loadAssetCasting(t.currentAsset)})).then((function(){t.castIn.isLoading=!1})).catch((function(s){t.castIn.isError=!0,console.error(s)}))):this.resetData()},computed:Object(n["a"])(Object(n["a"])({},Object(o["c"])(["assetMap","assetMetadataDescriptors","assetsPath","currentEpisode","currentProduction","isTVShow","isCurrentUserManager","route","shotId"])),{},{title:function(){return this.currentAsset?"".concat(this.currentAsset.asset_type_name," / ")+"".concat(this.currentAsset.name):"Loading..."},assetThumbnailPath:function(){var t=this.currentAsset.preview_file_id;return"/api/pictures/originals/preview-files/".concat(t,".png")},isPreview:function(){return this.currentAsset&&this.currentAsset.preview_file_id&&this.currentAsset.preview_file_id.length>0}}),methods:Object(n["a"])(Object(n["a"])({},Object(o["b"])(["clearSelectedTasks","editAsset","loadAssets","loadAssetCastIn","loadAssetCasting","loadShots","setCurrentEpisode"])),{},{onChangeMetadata:function(t){if(console.log(t),this.currentAsset.data){var s=Object(n["a"])({},this.currentAsset.data);s.metadata=JSON.parse(t);var e={id:this.currentAsset.id,source_id:this.currentAsset.episode_id,episode_id:this.currentAsset.episode_id,data:s};this.editAsset(e)}},changeTab:function(t){this.selectedTab=t},getCurrentAsset:function(){return this.assetMap[this.route.params.asset_id]||null},onEditClicked:function(){this.modals.edit=!0},confirmEditAsset:function(t){var s=this;t.id=this.currentAsset.id,this.loading.edit=!0,this.errors.edit=!1,this.editAsset(t).then((function(){s.loading.edit=!1,s.modals.edit=!1})).catch((function(t){console.error(t),s.loading.edit=!1,s.errors.edit=!0}))},onTaskSelected:function(t){this.currentTask=t},resetData:function(){var t=this;"main"===this.$route.params.episode_id&&this.setCurrentEpisode("main"),this.loadAssets().then((function(){return t.currentAsset=t.getCurrentAsset(),t.loadAssetCastIn(t.currentAsset)})).then((function(){return t.loadAssetCasting(t.currentAsset)})).then((function(){t.castIn.isLoading=!1})).catch((function(s){t.castIn.isError=!0,console.error(s)}))},shotPath:function(t){return{name:t.episode_id?"episode-shot":"shot",params:{production_id:this.currentProduction.id,shot_id:t.shot_id,episode_id:t.episode_id?t.episode_id:void 0}}}}),watch:{currentProduction:function(){this.isTVShow||this.resetData()},currentEpisode:function(){this.isTVShow&&"main"!==this.currentEpisode.id&&this.resetData()}},metaInfo:function(){return{title:"".concat(this.title," - Kitsu")}}},g=v,C=(e("64032"),e("2877")),y=Object(C["a"])(g,a,i,!1,null,"5cd7e8b9",null);s["default"]=y.exports},"4e73":function(t,s,e){},64032:function(t,s,e){"use strict";e("4e73")}}]);
//# sourceMappingURL=chunk-53b747de.c121f2af.js.map