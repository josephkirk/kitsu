{"version":3,"sources":["webpack:///./src/components/pages/Asset.vue?4dd3","webpack:///src/components/pages/Asset.vue","webpack:///./src/components/pages/Asset.vue?24fa","webpack:///./src/components/pages/Asset.vue","webpack:///./src/components/pages/Asset.vue?6702"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","assetsPath","currentAsset","_e","title","on","$event","modals","edit","$t","tasks","onTaskSelected","_v","_s","_l","descriptor","key","id","name","data","field_name","options","model","value","callback","$$v","metadata","expression","castInShotsBySequence","length","sequenceShots","sequence_name","shot","shot_id","shotPath","shot_name","nb_occurences","castIn","isLoadin","isError","castingAssetsByType","typeAssets","asset_type_name","asset","params","production_id","currentProduction","asset_id","asset_name","currentTask","ref","loading","errors","confirmEditAsset","staticRenderFns","components","VJsoneditor","ButtonSimple","ChevronLeftIcon","DescriptionCell","EditAssetModal","EntityThumbnail","EntityTaskList","PageSubtitle","PageTitle","TableInfo","TaskInfo","isLoading","mode","modes","mounted","clearSelectedTasks","getCurrentAsset","Object","assign","onChangeText","onChangeMetadata","loadAssetCastIn","resetData","computed","assetThumbnailPath","isPreview","methods","console","log","jsonstring","assetdata","JSON","parse","source_id","episode_id","editAsset","changeTab","selectedTab","tab","assetMap","route","onEditClicked","form","task","$route","setCurrentEpisode","loadAssets","undefined","watch","isTVShow","currentEpisode","metaInfo","component"],"mappings":"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","file":"js/chunk-53b747de.c121f2af.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"columns fixed-page asset\"},[_c('div',{staticClass:\"column main-column\"},[_c('div',{staticClass:\"page-header flexrow\"},[_c('router-link',{staticClass:\"flexrow-item has-text-centered back-link\",attrs:{\"to\":_vm.assetsPath}},[_c('chevron-left-icon')],1),(_vm.currentAsset)?_c('entity-thumbnail',{staticClass:\"asset-thumbnail flexrow-item\",attrs:{\"entity\":_vm.currentAsset,\"with-link\":false}}):_vm._e(),_c('div',{staticClass:\"flexrow-item\"},[_c('page-title',{staticClass:\"entity-title\",attrs:{\"text\":_vm.title}})],1),_c('div',{staticClass:\"flexrow-item\"},[(_vm.isCurrentUserManager)?_c('button-simple',{attrs:{\"icon\":\"edit\"},on:{\"click\":function($event){_vm.modals.edit = true}}}):_vm._e()],1)],1),_c('div',{staticClass:\"flexrow infos\"},[_c('div',{staticClass:\"flexrow-item\"},[_c('page-subtitle',{attrs:{\"text\":_vm.$t('assets.tasks')}}),_c('entity-task-list',{staticClass:\"task-list\",attrs:{\"entries\":_vm.currentAsset ? _vm.currentAsset.tasks : [],\"is-loading\":!_vm.currentAsset,\"is-error\":false},on:{\"task-selected\":_vm.onTaskSelected}})],1),_c('div',{staticClass:\"flexrow-item\"},[_c('page-subtitle',{attrs:{\"text\":_vm.$t('main.info')}}),_c('div',{staticClass:\"table-body\"},[(_vm.currentAsset)?_c('table',{staticClass:\"datatable\"},[_c('tbody',{staticClass:\"table-body\"},[_c('tr',{staticClass:\"datatable-row\"},[_c('td',{staticClass:\"field-label\"},[_vm._v(_vm._s(_vm.$t('assets.fields.description')))]),_c('description-cell',{attrs:{\"entry\":_vm.currentAsset,\"full\":true}})],1),_vm._l((_vm.assetMetadataDescriptors),function(descriptor){return _c('tr',{key:descriptor.id,staticClass:\"datatable-row\"},[_c('td',{staticClass:\"field-label\"},[_vm._v(_vm._s(descriptor.name))]),_c('td',[_vm._v(\" \"+_vm._s(_vm.currentAsset.data ? _vm.currentAsset.data[descriptor.field_name] : '')+\" \")])])}),_c('tr',{staticClass:\"datatable-row\"},[_c('td',{staticClass:\"field-label\"},[_vm._v(\"Metadata\")]),_c('td',[_c('v-jsoneditor',{staticClass:\"json-editor\",attrs:{\"options\":_vm.options,\"plus\":true,\"height\":\"400px\"},model:{value:(_vm.metadata),callback:function ($$v) {_vm.metadata=$$v},expression:\"metadata\"}})],1)])],2)]):_vm._e()])],1)]),_c('div',{staticClass:\"asset-casted-in\"},[_c('page-subtitle',{attrs:{\"text\":_vm.$t('assets.cast_in')}}),(_vm.currentAsset)?_c('div',[(_vm.currentAsset.castInShotsBySequence &&\r\n                _vm.currentAsset.castInShotsBySequence[0].length > 0)?_c('div',_vm._l((_vm.currentAsset.castInShotsBySequence),function(sequenceShots){return (sequenceShots[0].sequence_name)?_c('div',{key:sequenceShots.length > 0 ? sequenceShots[0].sequence_name : '',staticClass:\"sequence-shots\"},[_c('div',{staticClass:\"shot-sequence\"},[_vm._v(\" \"+_vm._s(sequenceShots.length > 0 ? sequenceShots[0].sequence_name : '')+\" \")]),_c('div',{staticClass:\"shot-list\"},_vm._l((sequenceShots),function(shot){return _c('router-link',{key:shot.shot_id,staticClass:\"shot-link\",attrs:{\"to\":_vm.shotPath(shot)}},[_c('entity-thumbnail',{attrs:{\"entity\":shot,\"square\":true,\"empty-width\":103,\"empty-height\":103,\"with-link\":false}}),_c('div',[_c('span',[_vm._v(_vm._s(shot.shot_name))]),(shot.nb_occurences > 1)?_c('span',[_vm._v(\" (\"+_vm._s(shot.nb_occurences)+\") \")]):_vm._e()])],1)}),1)]):_vm._e()}),0):_c('div',[_vm._v(\" \"+_vm._s(_vm.$t('assets.no_cast_in'))+\" \")])]):_c('table-info',{attrs:{\"is-loading\":_vm.castIn.isLoadin,\"is-error\":_vm.castIn.isError}}),(_vm.currentAsset && _vm.currentAsset.castingAssetsByType &&\r\n          _vm.currentAsset.castingAssetsByType[0].length > 0)?_c('div',[_c('page-subtitle',{attrs:{\"text\":\"Linked\"}}),(_vm.currentAsset.castingAssetsByType && _vm.currentAsset.castingAssetsByType[0].length > 0)?_c('div',_vm._l((_vm.currentAsset.castingAssetsByType),function(typeAssets){return _c('div',{key:typeAssets.length > 0 ? typeAssets[0].asset_type_name : '',staticClass:\"type-assets\"},[_c('div',{staticClass:\"asset-type\"},[_vm._v(\" \"+_vm._s(typeAssets.length > 0 ? typeAssets[0].asset_type_name : '')+\" (\"+_vm._s(typeAssets.length)+\") \")]),_c('div',{staticClass:\"asset-list\"},_vm._l((typeAssets),function(asset){return _c('router-link',{key:asset.id,staticClass:\"asset-link\",attrs:{\"to\":{\r\n                  name: 'asset',\r\n                  params: {\r\n                    production_id: _vm.currentProduction.id,\r\n                    asset_id: asset.asset_id\r\n                  }\r\n                }}},[_c('entity-thumbnail',{attrs:{\"entity\":asset,\"square\":true,\"empty-width\":103,\"empty-height\":103,\"with-link\":false}}),_c('div',[_c('span',[_vm._v(_vm._s(asset.asset_name))]),(asset.nb_occurences > 1)?_c('span',[_vm._v(\" (\"+_vm._s(asset.nb_occurences)+\") \")]):_vm._e()])],1)}),1)])}),0):_vm._e()],1):_vm._e()],1)]),(_vm.currentTask)?_c('div',{staticClass:\"column side-column\"},[_c('task-info',{attrs:{\"task\":_vm.currentTask}})],1):_vm._e(),_c('edit-asset-modal',{ref:\"edit-asset-modal\",attrs:{\"active\":_vm.modals.edit,\"is-loading\":_vm.loading.edit,\"is-error\":_vm.errors.edit,\"asset-to-edit\":_vm.currentAsset},on:{\"cancel\":function($event){_vm.modals.edit = false},\"confirm\":_vm.confirmEditAsset}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div class=\"columns fixed-page asset\">\r\n  <div class=\"column main-column\">\r\n    <div class=\"page-header flexrow\">\r\n      <router-link\r\n        class=\"flexrow-item has-text-centered back-link\"\r\n        :to=\"assetsPath\"\r\n      >\r\n        <chevron-left-icon />\r\n      </router-link>\r\n      <entity-thumbnail\r\n        class=\"asset-thumbnail flexrow-item\"\r\n        :entity=\"currentAsset\"\r\n        :with-link=\"false\"\r\n        v-if=\"currentAsset\"\r\n      />\r\n      <div class=\"flexrow-item\">\r\n        <page-title :text=\"title\" class=\"entity-title\" />\r\n      </div>\r\n      <div class=\"flexrow-item\">\r\n        <button-simple\r\n          icon=\"edit\"\r\n          @click=\"modals.edit = true\"\r\n          v-if=\"isCurrentUserManager\"\r\n        />\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"flexrow infos\">\r\n      <div class=\"flexrow-item\">\r\n        <page-subtitle :text=\"$t('assets.tasks')\" />\r\n        <entity-task-list\r\n          class=\"task-list\"\r\n          :entries=\"currentAsset ? currentAsset.tasks : []\"\r\n          :is-loading=\"!currentAsset\"\r\n          :is-error=\"false\"\r\n          @task-selected=\"onTaskSelected\"\r\n        />\r\n      </div>\r\n      <div class=\"flexrow-item\">\r\n        <page-subtitle :text=\"$t('main.info')\" />\r\n        <div class=\"table-body\">\r\n          <table class=\"datatable\" v-if=\"currentAsset\">\r\n            <tbody class=\"table-body\">\r\n              <tr\r\n                class=\"datatable-row\"\r\n              >\r\n                <td class=\"field-label\">{{ $t('assets.fields.description') }}</td>\r\n                <description-cell\r\n                  :entry=\"currentAsset\"\r\n                  :full=\"true\"\r\n                />\r\n              </tr>\r\n              <tr\r\n                :key=\"descriptor.id\"\r\n                class=\"datatable-row\"\r\n                v-for=\"descriptor in assetMetadataDescriptors\"\r\n              >\r\n                <td class=\"field-label\">{{ descriptor.name }}</td>\r\n                <td>\r\n                  {{ currentAsset.data ? currentAsset.data[descriptor.field_name] : '' }}\r\n                </td>\r\n              </tr>\r\n              <tr class=\"datatable-row\">\r\n                <td class=\"field-label\">Metadata</td>\r\n                <td>\r\n                    <v-jsoneditor class=\"json-editor\" v-model=\"metadata\" :options=\"options\" :plus=\"true\" height=\"400px\"/>\r\n                </td>\r\n              </tr>\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"asset-casted-in\">\r\n      <page-subtitle :text=\"$t('assets.cast_in')\" />\r\n      <div v-if=\"currentAsset\">\r\n        <div\r\n          v-if=\"currentAsset.castInShotsBySequence &&\r\n                currentAsset.castInShotsBySequence[0].length > 0\"\r\n        >\r\n          <div\r\n            class=\"sequence-shots\"\r\n            :key=\"sequenceShots.length > 0 ? sequenceShots[0].sequence_name : ''\"\r\n            v-if=\"sequenceShots[0].sequence_name\"\r\n            v-for=\"sequenceShots in currentAsset.castInShotsBySequence\"\r\n          >\r\n            <div class=\"shot-sequence\">\r\n              {{ sequenceShots.length > 0 ? sequenceShots[0].sequence_name : '' }}\r\n            </div>\r\n            <div class=\"shot-list\">\r\n              <router-link\r\n                class=\"shot-link\"\r\n                :key=\"shot.shot_id\"\r\n                :to=\"shotPath(shot)\"\r\n                v-for=\"shot in sequenceShots\"\r\n              >\r\n                <entity-thumbnail\r\n                  :entity=\"shot\"\r\n                  :square=\"true\"\r\n                  :empty-width=\"103\"\r\n                  :empty-height=\"103\"\r\n                  :with-link=\"false\"\r\n                />\r\n                <div>\r\n                  <span>{{ shot.shot_name }}</span>\r\n                  <span v-if=\"shot.nb_occurences > 1\">\r\n                    ({{ shot.nb_occurences }})\r\n                  </span>\r\n                </div>\r\n              </router-link>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div v-else>\r\n          {{ $t('assets.no_cast_in') }}\r\n        </div>\r\n      </div>\r\n      <table-info\r\n        :is-loading=\"castIn.isLoadin\"\r\n        :is-error=\"castIn.isError\"\r\n        v-else\r\n      />\r\n\r\n      <div v-if=\"currentAsset && currentAsset.castingAssetsByType &&\r\n          currentAsset.castingAssetsByType[0].length > 0\">\r\n        <page-subtitle text=\"Linked\" />\r\n        <div\r\n            v-if=\"currentAsset.castingAssetsByType && currentAsset.castingAssetsByType[0].length > 0\"\r\n        >\r\n          <div\r\n            class=\"type-assets\"\r\n            :key=\"typeAssets.length > 0 ? typeAssets[0].asset_type_name : ''\"\r\n            v-for=\"typeAssets in currentAsset.castingAssetsByType\"\r\n          >\r\n            <div class=\"asset-type\">\r\n              {{ typeAssets.length > 0 ? typeAssets[0].asset_type_name : '' }}\r\n              ({{ typeAssets.length }})\r\n            </div>\r\n            <div class=\"asset-list\">\r\n              <router-link\r\n                class=\"asset-link\"\r\n                :key=\"asset.id\"\r\n                :to=\"{\r\n                  name: 'asset',\r\n                  params: {\r\n                    production_id: currentProduction.id,\r\n                    asset_id: asset.asset_id\r\n                  }\r\n                }\"\r\n                v-for=\"asset in typeAssets\"\r\n              >\r\n                <entity-thumbnail\r\n                  :entity=\"asset\"\r\n                  :square=\"true\"\r\n                  :empty-width=\"103\"\r\n                  :empty-height=\"103\"\r\n                  :with-link=\"false\"\r\n                />\r\n                <div>\r\n                  <span>{{ asset.asset_name }}</span>\r\n                  <span v-if=\"asset.nb_occurences > 1\">\r\n                    ({{ asset.nb_occurences }})\r\n                  </span>\r\n                </div>\r\n              </router-link>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n\r\n  <div\r\n    class=\"column side-column\"\r\n    v-if=\"currentTask\"\r\n  >\r\n    <task-info\r\n      :task=\"currentTask\"\r\n    />\r\n  </div>\r\n\r\n  <edit-asset-modal\r\n    ref=\"edit-asset-modal\"\r\n    :active=\"modals.edit\"\r\n    :is-loading=\"loading.edit\"\r\n    :is-error=\"errors.edit\"\r\n    :asset-to-edit=\"currentAsset\"\r\n    @cancel=\"modals.edit = false\"\r\n    @confirm=\"confirmEditAsset\"\r\n  />\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport VJsoneditor from 'v-jsoneditor'\r\nimport { mapGetters, mapActions } from 'vuex'\r\n\r\nimport { ChevronLeftIcon } from 'vue-feather-icons'\r\nimport ButtonSimple from '../widgets/ButtonSimple'\r\nimport DescriptionCell from '../cells/DescriptionCell'\r\nimport EditAssetModal from '../modals/EditAssetModal'\r\nimport EntityTaskList from '../lists/EntityTaskList'\r\nimport EntityThumbnail from '../widgets/EntityThumbnail'\r\nimport PageTitle from '../widgets/PageTitle'\r\nimport PageSubtitle from '../widgets/PageSubtitle'\r\nimport TableInfo from '../widgets/TableInfo'\r\nimport TaskInfo from '../sides/TaskInfo'\r\n\r\nexport default {\r\n  name: 'asset',\r\n  components: {\r\n    VJsoneditor,\r\n    ButtonSimple,\r\n    ChevronLeftIcon,\r\n    DescriptionCell,\r\n    EditAssetModal,\r\n    EntityThumbnail,\r\n    EntityTaskList,\r\n    PageSubtitle,\r\n    PageTitle,\r\n    TableInfo,\r\n    TaskInfo\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      currentAsset: null,\r\n      currentTask: null,\r\n      castIn: {\r\n        isLoading: false,\r\n        isError: false\r\n      },\r\n      errors: {\r\n        edit: false\r\n      },\r\n      loading: {\r\n        edit: false\r\n      },\r\n      modals: {\r\n        edit: false\r\n      },\r\n      metadata: {},\r\n      options: {\r\n        name: 'metadata root',\r\n        mode: 'preview',\r\n        modes: ['tree', 'preview', 'form', 'code']\r\n      }\r\n    }\r\n  },\r\n\r\n  mounted () {\r\n    this.clearSelectedTasks()\r\n    this.currentAsset = this.getCurrentAsset()\r\n    // this.json = this.currentAsset.data.metadata ? this.currentAsset.data.metadata : {}\r\n    this.castIn.isLoading = true\r\n    this.castIn.isError = false\r\n    Object.assign(this.options, {\r\n      onChangeText: this.onChangeMetadata\r\n    })\r\n    if (this.currentAsset) {\r\n      if (this.currentAsset.data) {\r\n        if (this.currentAsset.data.metadata) {\r\n          this.metadata = this.currentAsset.data.metadata\r\n        }\r\n      }\r\n      this.loadAssetCastIn(this.currentAsset)\r\n        .then(() => this.loadAssetCasting(this.currentAsset))\r\n        .then(() => {\r\n          this.castIn.isLoading = false\r\n        })\r\n        .catch((err) => {\r\n          this.castIn.isError = true\r\n          console.error(err)\r\n        })\r\n    } else {\r\n      this.resetData()\r\n    }\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters([\r\n      'assetMap',\r\n      'assetMetadataDescriptors',\r\n      'assetsPath',\r\n      'currentEpisode',\r\n      'currentProduction',\r\n      'isTVShow',\r\n      'isCurrentUserManager',\r\n      'route',\r\n      'shotId'\r\n    ]),\r\n\r\n    title () {\r\n      if (this.currentAsset) {\r\n        return `${this.currentAsset.asset_type_name} / ` +\r\n               `${this.currentAsset.name}`\r\n      } else {\r\n        return 'Loading...'\r\n      }\r\n    },\r\n\r\n    assetThumbnailPath () {\r\n      const previewId = this.currentAsset.preview_file_id\r\n      return `/api/pictures/originals/preview-files/${previewId}.png`\r\n    },\r\n\r\n    isPreview () {\r\n      return this.currentAsset &&\r\n        this.currentAsset.preview_file_id &&\r\n        this.currentAsset.preview_file_id.length > 0\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions([\r\n      'clearSelectedTasks',\r\n      'editAsset',\r\n      'loadAssets',\r\n      'loadAssetCastIn',\r\n      'loadAssetCasting',\r\n      'loadShots',\r\n      'setCurrentEpisode'\r\n    ]),\r\n\r\n    onChangeMetadata (jsonstring) {\r\n      console.log(jsonstring)\r\n      if (this.currentAsset.data) {\r\n        const assetdata = { ...this.currentAsset.data }\r\n        assetdata.metadata = JSON.parse(jsonstring)\r\n        const data = {\r\n          id: this.currentAsset.id,\r\n          source_id: this.currentAsset.episode_id,\r\n          episode_id: this.currentAsset.episode_id,\r\n          data: assetdata\r\n        }\r\n        this.editAsset(data)\r\n      }\r\n    },\r\n\r\n    changeTab (tab) {\r\n      this.selectedTab = tab\r\n    },\r\n\r\n    getCurrentAsset () {\r\n      return this.assetMap[this.route.params.asset_id] || null\r\n    },\r\n\r\n    onEditClicked () {\r\n      this.modals.edit = true\r\n    },\r\n\r\n    confirmEditAsset (form) {\r\n      form.id = this.currentAsset.id\r\n      this.loading.edit = true\r\n      this.errors.edit = false\r\n      this.editAsset(form)\r\n        .then(() => {\r\n          this.loading.edit = false\r\n          this.modals.edit = false\r\n        })\r\n        .catch((err) => {\r\n          console.error(err)\r\n          this.loading.edit = false\r\n          this.errors.edit = true\r\n        })\r\n    },\r\n\r\n    onTaskSelected (task) {\r\n      this.currentTask = task\r\n    },\r\n\r\n    resetData () {\r\n      if (this.$route.params.episode_id === 'main') {\r\n        this.setCurrentEpisode('main')\r\n      }\r\n      this.loadAssets()\r\n        .then(() => {\r\n          this.currentAsset = this.getCurrentAsset()\r\n          return this.loadAssetCastIn(this.currentAsset)\r\n        })\r\n        .then(() => this.loadAssetCasting(this.currentAsset))\r\n        .then(() => {\r\n          this.castIn.isLoading = false\r\n        })\r\n        .catch((err) => {\r\n          this.castIn.isError = true\r\n          console.error(err)\r\n        })\r\n    },\r\n\r\n    shotPath (shot) {\r\n      return {\r\n        name: shot.episode_id ? 'episode-shot' : 'shot',\r\n        params: {\r\n          production_id: this.currentProduction.id,\r\n          shot_id: shot.shot_id,\r\n          episode_id: shot.episode_id ? shot.episode_id : undefined\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    currentProduction () {\r\n      if (!this.isTVShow) this.resetData()\r\n    },\r\n\r\n    currentEpisode () {\r\n      if (this.isTVShow && this.currentEpisode.id !== 'main') this.resetData()\r\n    }\r\n  },\r\n\r\n  metaInfo () {\r\n    return {\r\n      title: `${this.title} - Kitsu`\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\r\n.json-editor {\r\n  width: 100%;\r\n  height: 35px;\r\n  margin: 5px;\r\n  background-color: rgb(240, 240, 240);\r\n}\r\n\r\n.dark {\r\n  .page {\r\n    background: $dark-grey-light;\r\n    padding-bottom: 1em;\r\n  }\r\n\r\n  .page-header,\r\n  .asset-casted-in,\r\n  .infos,\r\n  .column {\r\n    background: #46494F;\r\n    border-color: $dark-grey;\r\n    box-shadow: 0px 0px 6px #333;\r\n  }\r\n\r\n  .task-list,\r\n  .table-body {\r\n    border: 1px solid $dark-grey;\r\n  }\r\n}\r\n\r\nh2.subtitle {\r\n  margin-top: 0;\r\n  margin-bottom: 0.5em;\r\n  font-weight: 300;\r\n  font-size: 1.5em;\r\n}\r\n\r\n.page {\r\n  background: #F9F9F9;\r\n  padding: 0em;\r\n}\r\n\r\n.page-header {\r\n  padding: 1em 1em 1em 1em;\r\n  background: white;\r\n  box-shadow: 0px 0px 6px #E0E0E0;\r\n  margin-top: calc(50px + 2em);\r\n  margin-bottom: 1.5em;\r\n  margin-left: 1em;\r\n  margin-right: 1em;\r\n}\r\n\r\n.infos {\r\n  padding: 1em 1em 1em 1em;\r\n  background: white;\r\n  box-shadow: 0px 0px 6px #E0E0E0;\r\n  margin-bottom: 1.5em;\r\n  margin-left: 1em;\r\n  margin-right: 1em;\r\n\r\n  .flexrow-item {\r\n    align-self: flex-start;\r\n    flex: 1;\r\n  }\r\n}\r\n\r\n.asset-casting,\r\n.asset-casted-in {\r\n  margin-left: 1em;\r\n  margin-right: 1em;\r\n  background: white;\r\n  padding: 1em;\r\n  box-shadow: 0px 0px 6px #E0E0E0;\r\n}\r\n\r\n.thumbnail-picture {\r\n  margin-bottom: 0.5em;\r\n}\r\n\r\n.sequence-shots {\r\n  margin-bottom: 3em;\r\n}\r\n\r\n.asset-type,\r\n.shot-sequence {\r\n  text-transform: uppercase;\r\n  font-size: 1.2em;\r\n  color: var(--text);\r\n  margin-top: 2em;\r\n  margin-bottom: 0.4em;\r\n}\r\n\r\n.asset-list,\r\n.shot-list {\r\n  color: var(--text);\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n}\r\n\r\n.asset-link,\r\n.shot-link {\r\n  color: inherit;\r\n  margin-right: 1em;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  font-size: 0.8em;\r\n}\r\n\r\n.asset-link div,\r\n.shot-link div {\r\n  max-width: 100px;\r\n}\r\n\r\n.asset-link span,\r\n.shot-link span {\r\n  word-wrap: break-word;\r\n}\r\n\r\n.field-label {\r\n  font-weight: bold;\r\n  width: 120px;\r\n}\r\n\r\n.page-header {\r\n  align-items: center;\r\n}\r\n\r\n.page-header .thumbnail-picture {\r\n  margin: 0 1em 0 0;\r\n  max-width: 80px;\r\n}\r\n\r\n.back-link {\r\n  padding-top: 3px;\r\n}\r\n\r\n.task-list {\r\n  max-width: 100%;\r\n}\r\n\r\n.datatable-row {\r\n  user-select: text;\r\n}\r\n\r\n@media screen and (max-width: 768px) {\r\n  .task-column {\r\n    margin-bottom: 1em;\r\n  }\r\n\r\n  .column:first-child {\r\n    margin-right: 0;\r\n  }\r\n\r\n  .entity-title {\r\n    font-size: 1.3em;\r\n    line-height: 1.5em;\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Asset.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Asset.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Asset.vue?vue&type=template&id=5cd7e8b9&scoped=true&\"\nimport script from \"./Asset.vue?vue&type=script&lang=js&\"\nexport * from \"./Asset.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Asset.vue?vue&type=style&index=0&id=5cd7e8b9&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5cd7e8b9\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Asset.vue?vue&type=style&index=0&id=5cd7e8b9&lang=scss&scoped=true&\""],"sourceRoot":""}