{"version":3,"sources":["webpack:///./src/components/pages/Person.vue?47d4","webpack:///./src/components/pages/Person.vue?68ac","webpack:///src/components/pages/Person.vue","webpack:///./src/components/pages/Person.vue?36c6","webpack:///./src/components/pages/Person.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","person","_e","name","class","isActiveTab","params","person_id","id","_v","_s","$t","on","$event","selectTab","tab","displayedPersonDoneTasks","length","ref","onSearchChange","saveSearchQuery","sortOptions","model","value","callback","$$v","currentSort","expression","personTaskSearchQueries","changeSearch","removeSearchQuery","sortedTasks","isTasksLoading","isTasksLoadingError","personTaskSelectionGrid","setPersonTasksScrollPosition","loggablePersonTasks","loggableDoneTasks","personTimeSpentMap","personTimeSpentTotal","personTasksSearchText","onDateChanged","onTimeSpentChange","onSetDayOff","onUnsetDayOff","nbSelectedTasks","Object","values","selectedTasks","staticRenderFns","components","Combobox","PageTitle","PeopleAvatar","SearchField","SearchQueryList","TaskInfo","TodosList","TimesheetList","data","activeTab","selectedDate","mounted","updateActiveTab","searchField","setValue","setTimeout","loadPerson","$route","afterDestroy","$store","commit","computed","displayedPersonTasks","$refs","taskList","haveDoneList","isName","tasks","sort","methods","setPersonTasksSearch","text","personMap","personId","loadPersonTasks","date","err","console","error","resizeHeaders","$nextTick","selectCurrent","selectDone","searchQuery","search_query","$emit","savePersonTasksSearch","removePersonTasksSearch","includes","timeSpentInfo","setTimeSpent","setDayOff","dayOff","unsetDayOff","metaInfo","title","watch","component"],"mappings":"gHAAA,W,yCCAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,MAAM,CAACE,YAAY,eAAe,CAACF,EAAG,MAAM,CAACE,YAAY,uBAAuB,CAAEN,EAAU,OAAEI,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,gBAAgB,CAACG,MAAM,CAAC,OAASP,EAAIQ,OAAO,KAAO,GAAG,YAAY,GAAG,WAAU,MAAU,GAAGR,EAAIS,KAAKL,EAAG,MAAM,CAACE,YAAY,gBAAgB,CAACF,EAAG,aAAa,CAACG,MAAM,CAAC,KAAOP,EAAIQ,OAASR,EAAIQ,OAAOE,KAAO,OAAO,KAAKN,EAAG,MAAM,CAACE,YAAY,kBAAkB,CAAEN,EAAU,OAAEI,EAAG,KAAK,CAACA,EAAG,KAAK,CAACO,MAAM,CAAC,YAAaX,EAAIY,YAAY,WAAW,CAACR,EAAG,cAAc,CAACG,MAAM,CAAC,GAAK,CACnqBG,KAAM,SACNG,OAAQ,CACNC,UAAWd,EAAIQ,OAAOO,OAEtB,CAACf,EAAIgB,GAAG,IAAIhB,EAAIiB,GAAGjB,EAAIkB,GAAG,kBAAkB,QAAQ,GAAGd,EAAG,KAAK,CAACO,MAAM,CAAC,YAAaX,EAAIY,YAAY,SAASO,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAIqB,UAAU,WAAW,CAACjB,EAAG,cAAc,CAACG,MAAM,CAAC,GAAK,CAC3MG,KAAM,aACNG,OAAQ,CACNS,IAAK,OACLR,UAAWd,EAAIQ,OAAOO,OAEtB,CAACf,EAAIgB,GAAG,IAAIhB,EAAIiB,GAAGjB,EAAIkB,GAAG,eAAe,KAAKlB,EAAIiB,GAAGjB,EAAIuB,yBAAyBC,QAAQ,SAAS,GAAIxB,EAAwB,qBAAEI,EAAG,KAAK,CAACO,MAAM,CAAC,YAAaX,EAAIY,YAAY,eAAeO,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOpB,EAAIqB,UAAU,iBAAiB,CAACjB,EAAG,cAAc,CAACG,MAAM,CAAC,GAAK,CACjSG,KAAM,aACNG,OAAQ,CACNS,IAAK,aACLR,UAAWd,EAAIQ,OAAOO,OAEtB,CAACf,EAAIgB,GAAG,IAAIhB,EAAIiB,GAAGjB,EAAIkB,GAAG,qBAAqB,QAAQ,GAAGlB,EAAIS,OAAOT,EAAIS,OAAOL,EAAG,MAAM,CAACE,YAAY,WAAW,CAAGN,EAAIY,YAAY,QAGlDZ,EAAIS,KAHuDL,EAAG,eAAe,CAACqB,IAAI,4BAA4Bd,MAAM,CAC1M,gBAAgB,EAChB,gBAAgB,GAChBJ,MAAM,CAAC,YAAW,GAAMY,GAAG,CAAC,OAASnB,EAAI0B,eAAe,KAAO1B,EAAI2B,mBAA4BvB,EAAG,OAAO,CAACE,YAAY,WAAWF,EAAG,WAAW,CAACE,YAAY,eAAeC,MAAM,CAAC,MAAQP,EAAIkB,GAAG,kBAAkB,QAAUlB,EAAI4B,YAAY,oBAAoB,iBAAiBC,MAAM,CAACC,MAAO9B,EAAe,YAAE+B,SAAS,SAAUC,GAAMhC,EAAIiC,YAAYD,GAAKE,WAAW,kBAAkB,GAAIlC,EAAIY,YAAY,UAAYZ,EAAIY,YAAY,cAAeR,EAAG,MAAM,CAACE,YAAY,cAAc,CAACF,EAAG,oBAAoB,CAACG,MAAM,CAAC,QAAUP,EAAImC,yBAAyBhB,GAAG,CAAC,gBAAgBnB,EAAIoC,aAAa,gBAAgBpC,EAAIqC,sBAAsB,GAAGrC,EAAIS,KAAMT,EAAIY,YAAY,SAAUR,EAAG,aAAa,CAACqB,IAAI,YAAYlB,MAAM,CAAC,MAAQP,EAAIsC,YAAY,aAAatC,EAAIuC,eAAe,WAAWvC,EAAIwC,oBAAoB,iBAAiBxC,EAAIyC,yBAAyBtB,GAAG,CAAC,OAASnB,EAAI0C,gCAAgC1C,EAAIS,KAAMT,EAAIY,YAAY,QAASR,EAAG,aAAa,CAACqB,IAAI,YAAYlB,MAAM,CAAC,MAAQP,EAAIuB,yBAAyB,aAAavB,EAAIuC,eAAe,WAAWvC,EAAIwC,oBAAoB,MAAO,EAAK,cAAgBxC,EAAIyC,2BAA2BzC,EAAIS,KAAMT,EAAIY,YAAY,cAAeR,EAAG,iBAAiB,CAACG,MAAM,CAAC,MAAQP,EAAI2C,oBAAoB,aAAa3C,EAAI4C,kBAAkB,aAAa5C,EAAIuC,eAAe,WAAWvC,EAAIwC,oBAAoB,iBAAiBxC,EAAI6C,mBAAmB,mBAAmB7C,EAAI8C,qBAAqB,YAAY9C,EAAI+C,sBAAsBvB,OAAS,GAAGL,GAAG,CAAC,eAAenB,EAAIgD,cAAc,oBAAoBhD,EAAIiD,kBAAkB,cAAcjD,EAAIkD,YAAY,gBAAgBlD,EAAImD,iBAAiBnD,EAAIS,MAAM,KAA8B,IAAxBT,EAAIoD,gBAAuBhD,EAAG,MAAM,CAACE,YAAY,sBAAsB,CAACF,EAAG,YAAY,CAACG,MAAM,CAAC,KAAO8C,OAAOC,OAAOtD,EAAIuD,eAAe,OAAO,GAAGvD,EAAIS,QAC5vD+C,EAAkB,G,wNC0ItB,GACE9C,KAAM,SACN+C,WAAY,CACVC,SAAJ,OACIC,UAAJ,OACIC,aAAJ,OACIC,YAAJ,OACIC,gBAAJ,OACIC,SAAJ,OACIC,UAAJ,OACIC,cAAJ,QAGEC,KAbF,WAcI,MAAO,CACLC,UAAW,QACX5B,gBAAgB,EAChBC,qBAAqB,EACrBhC,OAAQ,KACR4D,aAAc,MAApB,qBACMnC,YAAa,cACbL,YAAa,CACnB,cACA,WACA,yBACA,aACA,qBACA,8CAIEyC,QA/BF,WA+BA,WACIpE,KAAKqE,kBACDrE,KAAK8C,sBAAsBvB,OAAS,GACtCvB,KAAKsE,YAAYC,SAASvE,KAAK8C,uBAEjC0B,YAAW,WACL,EAAV,qCACA,KACIxE,KAAKyE,WAAWzE,KAAK0E,OAAO9D,OAAOC,YAGrC8D,aA1CF,WA2CI3E,KAAK4E,OAAOC,OAChB,wBACA,CAAM,MAAN,GAAM,YAAN,GAAM,YAAN,oBAIEC,SAAU,OAAZ,OAAY,CAAZ,kBACA,gBACA,uBACA,2BACA,uBACA,kBACA,YACA,4BACA,wBACA,0BACA,0BACA,qBACA,uBACA,gBACA,iBAdA,IAiBIpC,oBAjBJ,WAiBA,WACM,OAAO1C,KAAK+E,qBAClB,oBACQ,OAAR,gDAIIpC,kBAxBJ,WAwBA,WACM,OAAO3C,KAAKsB,yBAClB,oBACQ,OAAR,gDAIIgD,YA/BJ,WAgCM,OAAOtE,KAAKgF,MAAM,8BAGpBC,SAnCJ,WAoCM,OAAOjF,KAAKgF,MAAM,cAGpBE,aAvCJ,WAwCM,OAAOlF,KAAKgF,MAAM,cAGpB3C,YA3CJ,WA4CM,IAAN,mCACA,4CACM,OAAI8C,EACKC,EAAMC,KACrB,oBACA,yBACA,4BAGeD,EAAMC,KACrB,yBACA,uBACA,yBACA,0BAMEC,QAAS,OAAX,OAAW,CAAX,kBACA,gBACA,kBACA,uBACA,wBACA,0BACA,YACA,+BACA,eACA,iBATA,IAYI3E,YAZJ,SAYA,GACM,OAAOX,KAAKkE,YAAc7C,GAG5BD,UAhBJ,SAgBA,cACMpB,KAAKkE,UAAY7C,EACbrB,KAAKW,YAAY,UACnB6D,YAAW,WACL,EAAd,qCACA,MAII/C,eAzBJ,SAyBA,GACMzB,KAAKuF,qBAAqBC,IAG5Bf,WA7BJ,SA6BA,cACMzE,KAAKO,OAASP,KAAKyF,UAAUC,GAC7B1F,KAAKsC,gBAAiB,EACtBtC,KAAK2F,gBAAgB,CACnBD,SAAU1F,KAAKO,OAAOO,GACtB8E,KAAM5F,KAAKmE,aACXrC,SAAU,SAAlB,GACc+D,GAAKC,QAAQC,MAAMF,GACvB,EAAV,kBACU,EAAV,uBACUrB,YAAW,WACL,EAAhB,UACc,EAAd,sBACgB,EAAhB,2BACA,gCAIY,EAAZ,kBACA,OAKIwB,cArDJ,WAqDA,WACMhG,KAAKiG,WAAU,WACT,EAAZ,qCACY,EAAZ,iDAIIC,cA5DJ,WA4DA,WACMlG,KAAKkE,UAAY,UACjBM,YAAW,WACT,EAAR,6CACA,MAGI2B,WAnEJ,WAoEMnG,KAAKkE,UAAY,QAGnB/B,aAvEJ,SAuEA,GACMnC,KAAKgF,MAAM,6BAA6BT,SAAS6B,EAAYC,cAC7DrG,KAAKgF,MAAM,6BAA6BsB,MAC9C,0BAII5E,gBA9EJ,SA8EA,GACM1B,KAAKuG,sBAAsBH,GACjC,qBAEA,mBACA,wBAIIhE,kBAvFJ,SAuFA,GACMpC,KAAKwG,wBAAwBJ,GACnC,qBAEA,mBACA,wBAII/B,gBAhGJ,WAiGU,CAAC,OAAQ,cAAcoC,SAASzG,KAAK0E,OAAO9D,OAAOS,KACrDrB,KAAKkE,UAAYlE,KAAK0E,OAAO9D,OAAOS,IAEpCrB,KAAKkE,UAAY,SAIrBlB,kBAxGJ,SAwGA,GACM0D,EAAchB,SAAW1F,KAAKO,OAAOO,GACrC4F,EAAcd,KAAO5F,KAAKmE,aAC1BnE,KAAK2G,aAAaD,IAGpB3D,cA9GJ,SA8GA,GACM/C,KAAKmE,aAAe,IAA1B,wBACMnE,KAAKyE,WAAWzE,KAAKO,OAAOO,KAG9BmC,YAnHJ,WAoHM,IAAN,GACQyC,SAAU1F,KAAKO,OAAOO,GACtB8E,KAAM5F,KAAKmE,cAEbnE,KAAK4G,UAAUC,IAGjB3D,cA3HJ,WA4HM,IAAN,GACQwC,SAAU1F,KAAKO,OAAOO,GACtB8E,KAAM5F,KAAKmE,cAEbnE,KAAK8G,YAAYD,MAIrBE,SApPF,WAqPI,MAAO,CACLC,MAAOhH,KAAKO,OAAS,GAA3B,oDAIE0G,MAAO,CACLvC,OADJ,WAEM,IAAN,+BAEM1E,KAAKqE,kBACDrE,KAAKO,OAAOO,KAAO4E,GAAU1F,KAAKyE,gBC9ZmT,I,wBCQ3VyC,EAAY,eACd,EACApH,EACAyD,GACA,EACA,KACA,WACA,MAIa,aAAA2D,E","file":"js/chunk-1f21b49d.c30f350e.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Person.vue?vue&type=style&index=0&id=5de1cd98&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"columns fixed-page\"},[_c('div',{staticClass:\"column main-column\"},[_c('div',{staticClass:\"person page\"},[_c('div',{staticClass:\"flexrow page-header\"},[(_vm.person)?_c('div',{staticClass:\"flexrow-item\"},[_c('people-avatar',{attrs:{\"person\":_vm.person,\"size\":80,\"font-size\":30,\"is-text\":false}})],1):_vm._e(),_c('div',{staticClass:\"flexrow-item\"},[_c('page-title',{attrs:{\"text\":_vm.person ? _vm.person.name : ''}})],1)]),_c('div',{staticClass:\"task-tabs tabs\"},[(_vm.person)?_c('ul',[_c('li',{class:{'is-active': _vm.isActiveTab('todos')}},[_c('router-link',{attrs:{\"to\":{\r\n              name: 'person',\r\n              params: {\r\n                person_id: _vm.person.id\r\n              }\r\n            }}},[_vm._v(\" \"+_vm._s(_vm.$t('tasks.current'))+\" \")])],1),_c('li',{class:{'is-active': _vm.isActiveTab('done')},on:{\"click\":function($event){return _vm.selectTab('done')}}},[_c('router-link',{attrs:{\"to\":{\r\n              name: 'person-tab',\r\n              params: {\r\n                tab: 'done',\r\n                person_id: _vm.person.id\r\n              }\r\n            }}},[_vm._v(\" \"+_vm._s(_vm.$t('tasks.done'))+\" (\"+_vm._s(_vm.displayedPersonDoneTasks.length)+\") \")])],1),(_vm.isCurrentUserManager)?_c('li',{class:{'is-active': _vm.isActiveTab('timesheets')},on:{\"click\":function($event){return _vm.selectTab('timesheets')}}},[_c('router-link',{attrs:{\"to\":{\r\n              name: 'person-tab',\r\n              params: {\r\n                tab: 'timesheets',\r\n                person_id: _vm.person.id\r\n              }\r\n            }}},[_vm._v(\" \"+_vm._s(_vm.$t('timesheets.title'))+\" \")])],1):_vm._e()]):_vm._e()]),_c('div',{staticClass:\"flexrow\"},[(!_vm.isActiveTab('done'))?_c('search-field',{ref:\"person-tasks-search-field\",class:{\r\n            'search-field': true,\r\n            'flexrow-item': true\r\n          },attrs:{\"can-save\":true},on:{\"change\":_vm.onSearchChange,\"save\":_vm.saveSearchQuery}}):_vm._e(),_c('span',{staticClass:\"filler\"}),_c('combobox',{staticClass:\"flexrow-item\",attrs:{\"label\":_vm.$t('main.sorted_by'),\"options\":_vm.sortOptions,\"locale-key-prefix\":\"tasks.fields.\"},model:{value:(_vm.currentSort),callback:function ($$v) {_vm.currentSort=$$v},expression:\"currentSort\"}})],1),(_vm.isActiveTab('todos') || _vm.isActiveTab('timesheets'))?_c('div',{staticClass:\"query-list\"},[_c('search-query-list',{attrs:{\"queries\":_vm.personTaskSearchQueries},on:{\"change-search\":_vm.changeSearch,\"remove-search\":_vm.removeSearchQuery}})],1):_vm._e(),(_vm.isActiveTab('todos'))?_c('todos-list',{ref:\"task-list\",attrs:{\"tasks\":_vm.sortedTasks,\"is-loading\":_vm.isTasksLoading,\"is-error\":_vm.isTasksLoadingError,\"selection-grid\":_vm.personTaskSelectionGrid},on:{\"scroll\":_vm.setPersonTasksScrollPosition}}):_vm._e(),(_vm.isActiveTab('done'))?_c('todos-list',{ref:\"done-list\",attrs:{\"tasks\":_vm.displayedPersonDoneTasks,\"is-loading\":_vm.isTasksLoading,\"is-error\":_vm.isTasksLoadingError,\"done\":true,\"selectionGrid\":_vm.personTaskSelectionGrid}}):_vm._e(),(_vm.isActiveTab('timesheets'))?_c('timesheet-list',{attrs:{\"tasks\":_vm.loggablePersonTasks,\"done-tasks\":_vm.loggableDoneTasks,\"is-loading\":_vm.isTasksLoading,\"is-error\":_vm.isTasksLoadingError,\"time-spent-map\":_vm.personTimeSpentMap,\"time-spent-total\":_vm.personTimeSpentTotal,\"hide-done\":_vm.personTasksSearchText.length > 0},on:{\"date-changed\":_vm.onDateChanged,\"time-spent-change\":_vm.onTimeSpentChange,\"set-day-off\":_vm.onSetDayOff,\"unset-day-off\":_vm.onUnsetDayOff}}):_vm._e()],1)]),(_vm.nbSelectedTasks === 1)?_c('div',{staticClass:\"column side-column\"},[_c('task-info',{attrs:{\"task\":Object.values(_vm.selectedTasks)[0]}})],1):_vm._e()])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div class=\"columns fixed-page\">\r\n  <div class=\"column main-column\">\r\n    <div class=\"person page\">\r\n\r\n      <div class=\"flexrow page-header\">\r\n        <div class=\"flexrow-item\" v-if=\"person\">\r\n          <people-avatar\r\n            :person=\"person\"\r\n            :size=\"80\"\r\n            :font-size=\"30\"\r\n            :is-text=\"false\"\r\n          />\r\n        </div>\r\n        <div class=\"flexrow-item\">\r\n          <page-title :text=\"person ? person.name : ''\" />\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"task-tabs tabs\">\r\n        <ul v-if=\"person\">\r\n          <li\r\n            :class=\"{'is-active': isActiveTab('todos')}\"\r\n          >\r\n            <router-link :to=\"{\r\n              name: 'person',\r\n              params: {\r\n                person_id: person.id\r\n              }\r\n            }\">\r\n              {{ $t('tasks.current')}}\r\n            </router-link>\r\n          </li>\r\n          <li\r\n            :class=\"{'is-active': isActiveTab('done')}\"\r\n            @click=\"selectTab('done')\"\r\n          >\r\n            <router-link :to=\"{\r\n              name: 'person-tab',\r\n              params: {\r\n                tab: 'done',\r\n                person_id: person.id\r\n              }\r\n            }\">\r\n              {{ $t('tasks.done') }} ({{ displayedPersonDoneTasks.length }})\r\n            </router-link>\r\n          </li>\r\n          <li\r\n            :class=\"{'is-active': isActiveTab('timesheets')}\"\r\n            @click=\"selectTab('timesheets')\"\r\n            v-if=\"isCurrentUserManager\"\r\n          >\r\n            <router-link :to=\"{\r\n              name: 'person-tab',\r\n              params: {\r\n                tab: 'timesheets',\r\n                person_id: person.id\r\n              }\r\n            }\">\r\n              {{ $t('timesheets.title') }}\r\n            </router-link>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n\r\n      <div class=\"flexrow\">\r\n        <search-field\r\n          :class=\"{\r\n            'search-field': true,\r\n            'flexrow-item': true\r\n          }\"\r\n          ref=\"person-tasks-search-field\"\r\n          @change=\"onSearchChange\"\r\n          @save=\"saveSearchQuery\"\r\n          :can-save=\"true\"\r\n          v-if=\"!isActiveTab('done')\"\r\n        />\r\n        <span class=\"filler\"></span>\r\n        <combobox\r\n          class=\"flexrow-item\"\r\n          :label=\"$t('main.sorted_by')\"\r\n          :options=\"sortOptions\"\r\n          locale-key-prefix=\"tasks.fields.\"\r\n          v-model=\"currentSort\"\r\n        />\r\n      </div>\r\n\r\n      <div\r\n        class=\"query-list\"\r\n        v-if=\"isActiveTab('todos') || isActiveTab('timesheets')\"\r\n      >\r\n        <search-query-list\r\n          :queries=\"personTaskSearchQueries\"\r\n          @change-search=\"changeSearch\"\r\n          @remove-search=\"removeSearchQuery\"\r\n        />\r\n      </div>\r\n\r\n      <todos-list\r\n        ref=\"task-list\"\r\n        :tasks=\"sortedTasks\"\r\n        :is-loading=\"isTasksLoading\"\r\n        :is-error=\"isTasksLoadingError\"\r\n        :selection-grid=\"personTaskSelectionGrid\"\r\n        @scroll=\"setPersonTasksScrollPosition\"\r\n        v-if=\"isActiveTab('todos')\"\r\n      />\r\n\r\n      <todos-list\r\n        ref=\"done-list\"\r\n        :tasks=\"displayedPersonDoneTasks\"\r\n        :is-loading=\"isTasksLoading\"\r\n        :is-error=\"isTasksLoadingError\"\r\n        :done=\"true\"\r\n        :selectionGrid=\"personTaskSelectionGrid\"\r\n        v-if=\"isActiveTab('done')\"\r\n      />\r\n\r\n      <timesheet-list\r\n        :tasks=\"loggablePersonTasks\"\r\n        :done-tasks=\"loggableDoneTasks\"\r\n        :is-loading=\"isTasksLoading\"\r\n        :is-error=\"isTasksLoadingError\"\r\n        :time-spent-map=\"personTimeSpentMap\"\r\n        :time-spent-total=\"personTimeSpentTotal\"\r\n        :hide-done=\"personTasksSearchText.length > 0\"\r\n        @date-changed=\"onDateChanged\"\r\n        @time-spent-change=\"onTimeSpentChange\"\r\n        @set-day-off=\"onSetDayOff\"\r\n        @unset-day-off=\"onUnsetDayOff\"\r\n        v-if=\"isActiveTab('timesheets')\"\r\n      />\r\n    </div>\r\n  </div>\r\n  <div\r\n    class=\"column side-column\"\r\n    v-if=\"nbSelectedTasks === 1\"\r\n  >\r\n    <task-info\r\n      :task=\"Object.values(selectedTasks)[0]\"\r\n    />\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nimport moment from 'moment-timezone'\r\nimport firstBy from 'thenby'\r\nimport { mapGetters, mapActions } from 'vuex'\r\n\r\nimport Combobox from '../widgets/Combobox'\r\nimport PageTitle from '../widgets/PageTitle'\r\nimport PeopleAvatar from '../widgets/PeopleAvatar'\r\nimport SearchField from '../widgets/SearchField'\r\nimport SearchQueryList from '../widgets/SearchQueryList'\r\nimport TimesheetList from '../lists/TimesheetList'\r\nimport TodosList from '../lists/TodosList'\r\nimport TaskInfo from '../sides/TaskInfo'\r\n\r\nexport default {\r\n  name: 'person',\r\n  components: {\r\n    Combobox,\r\n    PageTitle,\r\n    PeopleAvatar,\r\n    SearchField,\r\n    SearchQueryList,\r\n    TaskInfo,\r\n    TodosList,\r\n    TimesheetList\r\n  },\r\n\r\n  data () {\r\n    return {\r\n      activeTab: 'todos',\r\n      isTasksLoading: false,\r\n      isTasksLoadingError: false,\r\n      person: null,\r\n      selectedDate: moment().format('YYYY-MM-DD'),\r\n      currentSort: 'entity_name',\r\n      sortOptions: [\r\n        'entity_name',\r\n        'priority',\r\n        'task_status_short_name',\r\n        'estimation',\r\n        'last_comment_date'\r\n      ].map((name) => ({ label: name, value: name }))\r\n    }\r\n  },\r\n\r\n  mounted () {\r\n    this.updateActiveTab()\r\n    if (this.personTasksSearchText.length > 0) {\r\n      this.searchField.setValue(this.personTasksSearchText)\r\n    }\r\n    setTimeout(() => {\r\n      if (this.searchField) this.searchField.focus()\r\n    }, 100)\r\n    this.loadPerson(this.$route.params.person_id)\r\n  },\r\n\r\n  afterDestroy () {\r\n    this.$store.commit(\r\n      'LOAD_PERSON_TASKS_END',\r\n      { tasks: [], userFilters: {}, taskTypeMap: this.taskTypeMap }\r\n    )\r\n  },\r\n\r\n  computed: {\r\n    ...mapGetters([\r\n      'displayedPersonTasks',\r\n      'displayedPersonDoneTasks',\r\n      'isCurrentUserManager',\r\n      'nbSelectedTasks',\r\n      'personMap',\r\n      'personTasksScrollPosition',\r\n      'personTasksSearchText',\r\n      'personTaskSearchQueries',\r\n      'personTaskSelectionGrid',\r\n      'personTimeSpentMap',\r\n      'personTimeSpentTotal',\r\n      'selectedTasks',\r\n      'taskTypeMap'\r\n    ]),\r\n\r\n    loggablePersonTasks () {\r\n      return this.displayedPersonTasks\r\n        .filter((task) => {\r\n          return this.taskTypeMap[task.task_type_id].allow_timelog\r\n        })\r\n    },\r\n\r\n    loggableDoneTasks () {\r\n      return this.displayedPersonDoneTasks\r\n        .filter((task) => {\r\n          return this.taskTypeMap[task.task_type_id].allow_timelog\r\n        })\r\n    },\r\n\r\n    searchField () {\r\n      return this.$refs['person-tasks-search-field']\r\n    },\r\n\r\n    taskList () {\r\n      return this.$refs['task-list']\r\n    },\r\n\r\n    haveDoneList () {\r\n      return this.$refs['done-list']\r\n    },\r\n\r\n    sortedTasks () {\r\n      const isName = this.currentSort === 'entity_name'\r\n      const tasks = [...this.displayedPersonTasks]\r\n      if (isName) {\r\n        return tasks.sort(\r\n          firstBy('project_name')\r\n            .thenBy('task_type_name')\r\n            .thenBy('full_entity_name')\r\n        )\r\n      } else {\r\n        return tasks.sort(\r\n          firstBy(this.currentSort, -1)\r\n            .thenBy('project_name')\r\n            .thenBy('task_type_name')\r\n            .thenBy('entity_name')\r\n        )\r\n      }\r\n    }\r\n  },\r\n\r\n  methods: {\r\n    ...mapActions([\r\n      'loadPersonTasks',\r\n      'setPersonTasksSearch',\r\n      'savePersonTasksSearch',\r\n      'removePersonTasksSearch',\r\n      'setDayOff',\r\n      'setPersonTasksScrollPosition',\r\n      'setTimeSpent',\r\n      'unsetDayOff'\r\n    ]),\r\n\r\n    isActiveTab (tab) {\r\n      return this.activeTab === tab\r\n    },\r\n\r\n    selectTab (tab) {\r\n      this.activeTab = tab\r\n      if (this.isActiveTab('todos')) {\r\n        setTimeout(() => {\r\n          if (this.searchField) this.searchField.focus()\r\n        }, 100)\r\n      }\r\n    },\r\n\r\n    onSearchChange (text) {\r\n      this.setPersonTasksSearch(text)\r\n    },\r\n\r\n    loadPerson (personId) {\r\n      this.person = this.personMap[personId]\r\n      this.isTasksLoading = true\r\n      this.loadPersonTasks({\r\n        personId: this.person.id,\r\n        date: this.selectedDate,\r\n        callback: (err) => {\r\n          if (err) console.error(err)\r\n          this.isTasksLoading = false\r\n          this.isTasksLoadingError = false\r\n          setTimeout(() => {\r\n            if (this.taskList) {\r\n              this.$nextTick(() => {\r\n                this.taskList.setScrollPosition(\r\n                  this.personTasksScrollPosition\r\n                )\r\n              })\r\n            }\r\n            this.resizeHeaders()\r\n          }, 0)\r\n        }\r\n      })\r\n    },\r\n\r\n    resizeHeaders () {\r\n      this.$nextTick(() => {\r\n        if (this.taskList) this.taskList.resizeHeaders()\r\n        if (this.haveDoneList) this.haveDoneList.resizeHeaders()\r\n      })\r\n    },\r\n\r\n    selectCurrent () {\r\n      this.activeTab = 'current'\r\n      setTimeout(() => {\r\n        this.$refs['person-tasks-search-field'].focus()\r\n      }, 100)\r\n    },\r\n\r\n    selectDone () {\r\n      this.activeTab = 'done'\r\n    },\r\n\r\n    changeSearch (searchQuery) {\r\n      this.$refs['person-tasks-search-field'].setValue(searchQuery.search_query)\r\n      this.$refs['person-tasks-search-field'].$emit(\r\n        'change', searchQuery.search_query\r\n      )\r\n    },\r\n\r\n    saveSearchQuery (searchQuery) {\r\n      this.savePersonTasksSearch(searchQuery)\r\n        .then(() => {\r\n        })\r\n        .catch((err) => {\r\n          if (err) console.error(err)\r\n        })\r\n    },\r\n\r\n    removeSearchQuery (searchQuery) {\r\n      this.removePersonTasksSearch(searchQuery)\r\n        .then(() => {\r\n        })\r\n        .catch((err) => {\r\n          if (err) console.error(err)\r\n        })\r\n    },\r\n\r\n    updateActiveTab () {\r\n      if (['done', 'timesheets'].includes(this.$route.params.tab)) {\r\n        this.activeTab = this.$route.params.tab\r\n      } else {\r\n        this.activeTab = 'todos'\r\n      }\r\n    },\r\n\r\n    onTimeSpentChange (timeSpentInfo) {\r\n      timeSpentInfo.personId = this.person.id\r\n      timeSpentInfo.date = this.selectedDate\r\n      this.setTimeSpent(timeSpentInfo)\r\n    },\r\n\r\n    onDateChanged (date) {\r\n      this.selectedDate = moment(date).format('YYYY-MM-DD')\r\n      this.loadPerson(this.person.id)\r\n    },\r\n\r\n    onSetDayOff () {\r\n      const dayOff = {\r\n        personId: this.person.id,\r\n        date: this.selectedDate\r\n      }\r\n      this.setDayOff(dayOff)\r\n    },\r\n\r\n    onUnsetDayOff () {\r\n      const dayOff = {\r\n        personId: this.person.id,\r\n        date: this.selectedDate\r\n      }\r\n      this.unsetDayOff(dayOff)\r\n    }\r\n  },\r\n\r\n  metaInfo () {\r\n    return {\r\n      title: this.person ? `${this.person.name} - Kitsu` : '... - Kitsu'\r\n    }\r\n  },\r\n\r\n  watch: {\r\n    $route () {\r\n      const personId = this.$route.params.person_id\r\n\r\n      this.updateActiveTab()\r\n      if (this.person.id !== personId) this.loadPerson()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.name {\r\n  width: 230px;\r\n  min-width: 230px;\r\n}\r\n.email {\r\n  width: 210px;\r\n  min-width: 210px;\r\n}\r\n.phone {\r\n  width: 140px;\r\n  min-width: 140px;\r\n}\r\n.skills {\r\n  width: 250px;\r\n}\r\n\r\n.query-list {\r\n  margin-top: 1em;\r\n}\r\n\r\n.task-tabs {\r\n  margin-top: 2em;\r\n}\r\n\r\n.task-tabs ul {\r\n  margin: 0;\r\n}\r\n\r\n.data-list {\r\n  margin-top: 0;\r\n}\r\n\r\n.dark .main-column {\r\n  border-right: 3px solid $grey-strong;\r\n}\r\n\r\n.person {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.columns {\r\n  display: flex;\r\n  flex-direction: row;\r\n  padding: 0;\r\n}\r\n\r\n.column {\r\n  overflow-y: auto;\r\n  padding: 0;\r\n}\r\n\r\n.main-column {\r\n  border-right: 3px solid $light-grey;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Person.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Person.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Person.vue?vue&type=template&id=5de1cd98&scoped=true&\"\nimport script from \"./Person.vue?vue&type=script&lang=js&\"\nexport * from \"./Person.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Person.vue?vue&type=style&index=0&id=5de1cd98&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5de1cd98\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}